import{m as P,j as e}from"./index-CBMC5bpf.js";import{r as _}from"./charts-BdICjjZY.js";import{c as A,A as b,f as H,C as V,Z as R,h as D,D as I,G as F,l as W,g as Q,T as O}from"./icons-CZRcmTJT.js";import"./vendor-Csw2ODfV.js";import"./router-CzMViovD.js";const U="_dataLineage_lfo52_2",X="_header_lfo52_9",Y="_title_lfo52_13",q="_subtitle_lfo52_24",Z="_mainContent_lfo52_31",J="_controls_lfo52_37",K="_searchContainer_lfo52_49",ee="_searchIcon_lfo52_56",se="_searchInput_lfo52_66",te="_filterSelect_lfo52_87",ae="_clearButton_lfo52_104",ie="_filterIndicator_lfo52_120",ne="_clearFilterButton_lfo52_133",ce="_contentGrid_lfo52_148",oe="_visualizationPanel_lfo52_155",le="_legend_lfo52_164",re="_legendItem_lfo52_176",de="_legendDot_lfo52_185",me="_source_lfo52_192",he="_ingestion_lfo52_196",ue="_transformation_lfo52_200",fe="_enrichment_lfo52_204",xe="_destination_lfo52_208",_e="_lineageContainer_lfo52_212",ge="_lineageSvg_lfo52_220",ye="_sectionLabel_lfo52_227",je="_nodeGroup_lfo52_234",ve="_nodeRect_lfo52_239",pe="_selectedNode_lfo52_251",Ne="_nodeText_lfo52_257",Se="_nodeSubtext_lfo52_262",Ce="_connectionLine_lfo52_267",Te="_flowDot_lfo52_271",we="_tooltip_lfo52_276",Le="_sidePanel_lfo52_281",Pe="_sidePanelHeader_lfo52_291",be="_sidePanelTitle_lfo52_297",De="_statusBadge_lfo52_304",Ie="_statusHealthy_lfo52_313",Me="_statusWarning_lfo52_317",$e="_statusFailed_lfo52_321",ze="_statusProcessing_lfo52_325",ke="_sidePanelContent_lfo52_330",Ge="_detailSection_lfo52_339",Be="_detailTitle_lfo52_345",Ee="_detailDescription_lfo52_354",Ae="_metricGrid_lfo52_361",He="_metric_lfo52_361",Ve="_metricValue_lfo52_382",Re="_metricLabel_lfo52_389",Fe="_connectionsList_lfo52_396",We="_connectionItem_lfo52_402",Qe="_connectionDot_lfo52_418",Oe="_connectionName_lfo52_425",Ue="_connectionType_lfo52_432",Xe="_activityItem_lfo52_441",Ye="_activityIcon_lfo52_451",qe="_activityText_lfo52_456",Ze="_activityTime_lfo52_462",Je="_summaryGrid_lfo52_468",Ke="_summaryCard_lfo52_475",es="_summaryIcon_lfo52_492",ss="_summaryContent_lfo52_503",ts="_summaryValue_lfo52_507",as="_summaryLabel_lfo52_515",t={dataLineage:U,header:X,title:Y,subtitle:q,mainContent:Z,controls:J,searchContainer:K,searchIcon:ee,searchInput:se,filterSelect:te,clearButton:ae,filterIndicator:ie,clearFilterButton:ne,contentGrid:ce,visualizationPanel:oe,legend:le,legendItem:re,legendDot:de,source:me,ingestion:he,transformation:ue,enrichment:fe,destination:xe,lineageContainer:_e,lineageSvg:ge,sectionLabel:ye,nodeGroup:je,nodeRect:ve,selectedNode:pe,nodeText:Ne,nodeSubtext:Se,connectionLine:Ce,flowDot:Te,tooltip:we,sidePanel:Le,sidePanelHeader:Pe,sidePanelTitle:be,statusBadge:De,statusHealthy:Ie,statusWarning:Me,statusFailed:$e,statusProcessing:ze,sidePanelContent:ke,detailSection:Ge,detailTitle:Be,detailDescription:Ee,metricGrid:Ae,metric:He,metricValue:Ve,metricLabel:Re,connectionsList:Fe,connectionItem:We,connectionDot:Qe,connectionName:Oe,connectionType:Ue,activityItem:Xe,activityIcon:Ye,activityText:qe,activityTime:Ze,summaryGrid:Je,summaryCard:Ke,summaryIcon:es,summaryContent:ss,summaryValue:ts,summaryLabel:as},is=_.memo(()=>{const[p,S]=_.useState(""),[f,N]=_.useState("all"),[c,C]=_.useState(null),[M,T]=_.useState(null),[x,w]=_.useState([]),$=_.useRef(null),{nodes:y,connections:v}=_.useMemo(()=>{const s=[],n=[];return["LinkedIn","Twitter","Office365","AzureAD","GitHub","ThreatIntel","Exchange","Teams","SharePoint","PowerBI"].forEach((a,l)=>{s.push({id:`source-${a}`,name:a,type:"source",source:a,x:100,y:60+l*60,status:["healthy","warning","failed"][Math.floor(Math.random()*3)],recordsPerSecond:Math.floor(Math.random()*1e3)+100,avgProcessingTime:Math.floor(Math.random()*500)+50,connections:[],description:`Data ingestion from ${a} platform`,lastUpdate:new Date(Date.now()-Math.random()*36e5).toISOString(),dataQuality:Math.floor(Math.random()*20)+80})}),[{type:"ingestion",x:300},{type:"transformation",x:450},{type:"enrichment",x:600}].forEach(({type:a,x:l})=>{const i=P.filter(m=>f==="all"||m.source===f),r={};i.forEach(m=>{r[m.source]||(r[m.source]=[]),r[m.source].push(m)});let h=0;Object.entries(r).forEach(([,m])=>{m.slice(0,2).forEach(u=>{s.push({id:`${a}-${u.id}`,name:`${a.charAt(0).toUpperCase()+a.slice(1)} - ${u.name.split(" ").slice(0,3).join(" ")}`,type:a,source:u.source,x:l,y:60+h*60,status:u.status,recordsPerSecond:Math.floor(u.recordsProcessed/60),avgProcessingTime:u.avgProcessingTime,connections:[],description:`${a} pipeline: ${u.name}`,lastUpdate:u.lastRun.toISOString(),dataQuality:Math.floor(Math.random()*15)+85,actualPipeline:u}),h++})})}),["MSTIC Data Lake","Threat Intelligence DB","Security Analytics Store","Alert System","ML Training Data","Compliance Archive","Real-time Dashboard","API Gateway"].forEach((a,l)=>{s.push({id:`dest-${a}`,name:a,type:"destination",x:800,y:60+l*60,status:["healthy","warning"][Math.floor(Math.random()*2)],recordsPerSecond:Math.floor(Math.random()*500)+50,avgProcessingTime:Math.floor(Math.random()*100)+20,connections:[],description:`Data destination: ${a}`,lastUpdate:new Date(Date.now()-Math.random()*18e5).toISOString(),dataQuality:Math.floor(Math.random()*10)+90})}),s.forEach(a=>{a.type==="source"?s.filter(i=>i.type==="ingestion"&&i.source===a.source).forEach(i=>{const r=`${a.id}-${i.id}`;n.push({id:r,from:a.id,to:i.id,volume:["low","medium","high"][Math.floor(Math.random()*3)],health:a.status==="failed"?"error":a.status==="warning"?"warning":"healthy",animated:!0}),a.connections.push(i.id),i.connections.push(a.id)}):a.type==="ingestion"?s.filter(i=>i.type==="transformation"&&i.source===a.source).forEach(i=>{const r=`${a.id}-${i.id}`;n.push({id:r,from:a.id,to:i.id,volume:["medium","high"][Math.floor(Math.random()*2)],health:a.status==="failed"?"error":"healthy",animated:!0}),a.connections.push(i.id),i.connections.push(a.id)}):a.type==="transformation"?s.filter(i=>i.type==="enrichment"&&i.source===a.source).forEach(i=>{const r=`${a.id}-${i.id}`;n.push({id:r,from:a.id,to:i.id,volume:"high",health:"healthy",animated:!0}),a.connections.push(i.id),i.connections.push(a.id)}):a.type==="enrichment"&&s.filter(i=>i.type==="destination").slice(0,3).forEach(i=>{const r=`${a.id}-${i.id}`;n.push({id:r,from:a.id,to:i.id,volume:"high",health:"healthy",animated:!0}),a.connections.push(i.id),i.connections.push(a.id)})}),{nodes:s,connections:n}},[f]),j=y.filter(s=>{const n=s.name.toLowerCase().includes(p.toLowerCase())||s.source&&s.source.toLowerCase().includes(p.toLowerCase()),o=f==="all"||s.source===f||s.type==="destination";return n&&o}),z=s=>{const n=new Set,o=[],d=a=>{if(n.has(a))return;n.add(a),o.push(a),v.filter(i=>i.from===a).forEach(i=>{n.has(i.to)||d(i.to)})},g=y.find(a=>a.id===s);if((g==null?void 0:g.type)==="source")d(s);else{const a=new Set,l=i=>{if(a.has(i))return;a.add(i),o.push(i),v.filter(h=>h.from===i||h.to===i).forEach(h=>{const m=h.from===i?h.to:h.from;a.has(m)||l(m)})};l(s)}w([...new Set(o)])},k=s=>{C(s),z(s.id)},L=s=>{if(x.length>0&&!x.includes(s.id))return"#444";switch(s.type){case"source":return"#0078d4";case"ingestion":return"#52c41a";case"transformation":return"#faad14";case"enrichment":return"#8b5cf6";case"destination":return"#ef4444";default:return"#888"}},G=s=>{const n=x.includes(s.from)&&x.includes(s.to),o=c&&(s.from===c.id||s.to===c.id);return{strokeWidth:s.volume==="high"?"3":s.volume==="medium"?"2":"1",stroke:s.health==="error"?"#ef4444":s.health==="warning"?"#faad14":"#52c41a",opacity:x.length>0?n||o?"1":"0.15":"0.8",strokeDasharray:s.volume==="low"?"5,5":"none"}},B=s=>{switch(s){case"healthy":return e.jsx(D,{size:16,className:t.statusHealthy});case"warning":return e.jsx(O,{size:16,className:t.statusWarning});case"failed":return e.jsx(Q,{size:16,className:t.statusFailed});case"processing":return e.jsx(b,{size:16,className:t.statusProcessing});default:return null}},E=[...new Set(P.map(s=>s.source))];return e.jsxs("div",{className:t.dataLineage,children:[e.jsxs("div",{className:t.header,children:[e.jsx("h1",{className:t.title,children:"Interactive Data Lineage"}),e.jsx("p",{className:t.subtitle,children:"Visualize and explore data flow through your threat intelligence pipelines"})]}),"        ",e.jsxs("div",{className:t.mainContent,children:[f!=="all"&&e.jsxs("div",{className:t.filterIndicator,children:[e.jsxs("span",{children:["Filtering by source: ",e.jsx("strong",{children:f})]}),e.jsx("button",{onClick:()=>N("all"),className:t.clearFilterButton,children:"âœ•"})]}),e.jsxs("div",{className:t.controls,children:[e.jsxs("div",{className:t.searchContainer,children:[e.jsx(A,{className:t.searchIcon}),e.jsx("input",{type:"text",placeholder:"Search nodes and pipelines...",value:p,onChange:s=>S(s.target.value),className:t.searchInput})]}),e.jsxs("select",{value:f,onChange:s=>N(s.target.value),className:t.filterSelect,children:[e.jsx("option",{value:"all",children:"All Sources"}),E.map(s=>e.jsx("option",{value:s,children:s},s))]}),e.jsx("button",{className:t.clearButton,onClick:()=>{C(null),w([]),N("all"),S("")},children:"Reset View"})]}),e.jsxs("div",{className:t.contentGrid,children:[e.jsxs("div",{className:t.visualizationPanel,children:[e.jsxs("div",{className:t.legend,children:[e.jsxs("div",{className:t.legendItem,children:[e.jsx("div",{className:`${t.legendDot} ${t.source}`}),e.jsx("span",{children:"Data Sources"})]}),e.jsxs("div",{className:t.legendItem,children:[e.jsx("div",{className:`${t.legendDot} ${t.ingestion}`}),e.jsx("span",{children:"Ingestion"})]}),e.jsxs("div",{className:t.legendItem,children:[e.jsx("div",{className:`${t.legendDot} ${t.transformation}`}),e.jsx("span",{children:"Transformation"})]}),e.jsxs("div",{className:t.legendItem,children:[e.jsx("div",{className:`${t.legendDot} ${t.enrichment}`}),e.jsx("span",{children:"Enrichment"})]}),e.jsxs("div",{className:t.legendItem,children:[e.jsx("div",{className:`${t.legendDot} ${t.destination}`}),e.jsx("span",{children:"Destinations"})]})]}),e.jsx("div",{className:t.lineageContainer,children:e.jsxs("svg",{ref:$,className:t.lineageSvg,viewBox:"0 0 1000 800",preserveAspectRatio:"xMidYMid meet",children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"flowGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[e.jsx("stop",{offset:"0%",stopColor:"rgba(82, 196, 26, 0.1)"}),e.jsx("stop",{offset:"50%",stopColor:"rgba(82, 196, 26, 0.8)"}),e.jsx("stop",{offset:"100%",stopColor:"rgba(82, 196, 26, 0.1)"}),e.jsx("animateTransform",{attributeName:"gradientTransform",attributeType:"XML",type:"translate",values:"-100 0; 200 0; -100 0",dur:"3s",repeatCount:"indefinite"})]}),e.jsx("marker",{id:"arrowhead",markerWidth:"10",markerHeight:"7",refX:"9",refY:"3.5",orient:"auto",children:e.jsx("polygon",{points:"0 0, 10 3.5, 0 7",fill:"#52c41a"})}),e.jsx("marker",{id:"arrowheadHighlighted",markerWidth:"12",markerHeight:"8",refX:"10",refY:"4",orient:"auto",children:e.jsx("polygon",{points:"0 0, 12 4, 0 8",fill:"#ffffff",stroke:"#52c41a",strokeWidth:"1"})}),e.jsxs("filter",{id:"glow",children:[e.jsx("feGaussianBlur",{stdDeviation:"3",result:"coloredBlur"}),e.jsxs("feMerge",{children:[e.jsx("feMergeNode",{in:"coloredBlur"}),e.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),e.jsx("text",{x:"170",y:"30",className:t.sectionLabel,children:"Data Sources"}),e.jsx("text",{x:"370",y:"30",className:t.sectionLabel,children:"Ingestion"}),e.jsx("text",{x:"520",y:"30",className:t.sectionLabel,children:"Transformation"}),e.jsx("text",{x:"670",y:"30",className:t.sectionLabel,children:"Enrichment"}),e.jsx("text",{x:"870",y:"30",className:t.sectionLabel,children:"Destinations"}),v.filter(s=>{const n=j.find(d=>d.id===s.from),o=j.find(d=>d.id===s.to);return n&&o}).map(s=>{const n=j.find(l=>l.id===s.from),o=j.find(l=>l.id===s.to),d=G(s),g=x.includes(s.from)&&x.includes(s.to),a=c&&(s.from===c.id||s.to===c.id);return e.jsxs("g",{children:[e.jsx("line",{x1:n.x+140,y1:n.y+20,x2:o.x,y2:o.y+20,...d,markerEnd:g||a?"url(#arrowheadHighlighted)":"url(#arrowhead)",className:t.connectionLine}),s.animated&&(g||a||x.length===0)&&e.jsx("circle",{r:"3",fill:d.stroke,className:t.flowDot,children:e.jsx("animateMotion",{dur:"3s",repeatCount:"indefinite",path:`M${n.x+140},${n.y+20} L${o.x},${o.y+20}`})})]},s.id)}),j.map(s=>e.jsxs("g",{className:t.nodeGroup,onClick:()=>k(s),onMouseEnter:()=>T(s.id),onMouseLeave:()=>T(null),children:[e.jsx("rect",{x:s.x,y:s.y,width:"140",height:"40",fill:L(s),rx:"6",className:`${t.nodeRect} ${(c==null?void 0:c.id)===s.id?t.selectedNode:""}`,filter:(c==null?void 0:c.id)===s.id?"url(#glow)":"none"}),e.jsx("text",{x:s.x+70,y:s.y+16,textAnchor:"middle",fill:"white",fontSize:"10",fontWeight:"600",className:t.nodeText,children:s.name.length>16?`${s.name.substring(0,13)}...`:s.name}),e.jsxs("text",{x:s.x+70,y:s.y+30,textAnchor:"middle",fill:"rgba(255,255,255,0.8)",fontSize:"8",className:t.nodeSubtext,children:[s.recordsPerSecond,"/s"]}),e.jsx("circle",{cx:s.x+125,cy:s.y+10,r:"4",fill:s.status==="healthy"?"#52c41a":s.status==="warning"?"#faad14":s.status==="failed"?"#ef4444":"#1890ff"}),M===s.id&&e.jsxs("g",{className:t.tooltip,children:[e.jsx("rect",{x:s.x+150,y:s.y-10,width:"200",height:"60",fill:"rgba(0,0,0,0.9)",rx:"4",stroke:"#444"}),e.jsx("text",{x:s.x+160,y:s.y+5,fill:"white",fontSize:"10",fontWeight:"600",children:s.name}),e.jsxs("text",{x:s.x+160,y:s.y+18,fill:"#ccc",fontSize:"9",children:["Records/sec: ",s.recordsPerSecond]}),e.jsxs("text",{x:s.x+160,y:s.y+30,fill:"#ccc",fontSize:"9",children:["Avg Time: ",s.avgProcessingTime,"ms"]}),e.jsxs("text",{x:s.x+160,y:s.y+42,fill:"#ccc",fontSize:"9",children:["Quality: ",s.dataQuality,"%"]})]})]},s.id))]})})]}),c&&e.jsxs("div",{className:t.sidePanel,children:[e.jsxs("div",{className:t.sidePanelHeader,children:[e.jsx("h3",{className:t.sidePanelTitle,children:c.name}),e.jsxs("div",{className:t.statusBadge,children:[B(c.status),e.jsx("span",{children:c.status})]})]}),e.jsxs("div",{className:t.sidePanelContent,children:[e.jsxs("div",{className:t.detailSection,children:[e.jsx("h4",{className:t.detailTitle,children:"Overview"}),e.jsx("p",{className:t.detailDescription,children:c.description}),e.jsxs("div",{className:t.metricGrid,children:[e.jsxs("div",{className:t.metric,children:[e.jsx(b,{size:16}),e.jsxs("div",{children:[e.jsxs("div",{className:t.metricValue,children:[c.recordsPerSecond,"/s"]}),e.jsx("div",{className:t.metricLabel,children:"Records per second"})]})]}),e.jsxs("div",{className:t.metric,children:[e.jsx(H,{size:16}),e.jsxs("div",{children:[e.jsxs("div",{className:t.metricValue,children:[c.avgProcessingTime,"ms"]}),e.jsx("div",{className:t.metricLabel,children:"Avg processing time"})]})]}),e.jsxs("div",{className:t.metric,children:[e.jsx(V,{size:16}),e.jsxs("div",{children:[e.jsxs("div",{className:t.metricValue,children:[c.dataQuality,"%"]}),e.jsx("div",{className:t.metricLabel,children:"Data quality"})]})]}),e.jsxs("div",{className:t.metric,children:[e.jsx(R,{size:16}),e.jsxs("div",{children:[e.jsx("div",{className:t.metricValue,children:c.connections.length}),e.jsx("div",{className:t.metricLabel,children:"Connections"})]})]})]})]}),e.jsxs("div",{className:t.detailSection,children:[e.jsx("h4",{className:t.detailTitle,children:"Connected Pipelines"}),e.jsx("div",{className:t.connectionsList,children:c.connections.slice(0,5).map(s=>{const n=y.find(o=>o.id===s);return n?e.jsxs("div",{className:t.connectionItem,children:[e.jsx("div",{className:t.connectionDot,style:{backgroundColor:L(n)}}),e.jsx("span",{className:t.connectionName,children:n.name}),e.jsx("span",{className:t.connectionType,children:n.type})]},s):null})})]}),e.jsxs("div",{className:t.detailSection,children:[e.jsx("h4",{className:t.detailTitle,children:"Recent Activity"}),e.jsxs("div",{className:t.activityItem,children:[e.jsx("div",{className:t.activityIcon,children:e.jsx(D,{size:14})}),e.jsxs("div",{children:[e.jsx("div",{className:t.activityText,children:"Last updated"}),e.jsx("div",{className:t.activityTime,children:new Date(c.lastUpdate).toLocaleString()})]})]})]})]})]})]})]}),e.jsxs("div",{className:t.summaryGrid,children:[e.jsxs("div",{className:t.summaryCard,children:[e.jsx("div",{className:t.summaryIcon,children:e.jsx(I,{size:24})}),e.jsxs("div",{className:t.summaryContent,children:[e.jsx("div",{className:t.summaryValue,children:y.filter(s=>s.type==="source").length}),e.jsx("div",{className:t.summaryLabel,children:"Data Sources"})]})]}),e.jsxs("div",{className:t.summaryCard,children:[e.jsx("div",{className:t.summaryIcon,children:e.jsx(F,{size:24})}),e.jsxs("div",{className:t.summaryContent,children:[e.jsx("div",{className:t.summaryValue,children:y.filter(s=>["ingestion","transformation","enrichment"].includes(s.type)).length}),e.jsx("div",{className:t.summaryLabel,children:"Processing Pipelines"})]})]}),e.jsxs("div",{className:t.summaryCard,children:[e.jsx("div",{className:t.summaryIcon,children:e.jsx(W,{size:24})}),e.jsxs("div",{className:t.summaryContent,children:[e.jsx("div",{className:t.summaryValue,children:v.length}),e.jsx("div",{className:t.summaryLabel,children:"Data Flows"})]})]}),e.jsxs("div",{className:t.summaryCard,children:[e.jsx("div",{className:t.summaryIcon,children:e.jsx(I,{size:24})}),e.jsxs("div",{className:t.summaryContent,children:[e.jsx("div",{className:t.summaryValue,children:y.filter(s=>s.type==="destination").length}),e.jsx("div",{className:t.summaryLabel,children:"Destinations"})]})]})]})]})});is.displayName="DataLineage";export{is as default};
//# sourceMappingURL=DataLineage-Dvvs_ZcK.js.map
