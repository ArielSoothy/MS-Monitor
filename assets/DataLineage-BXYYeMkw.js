import{m as T,j as e}from"./index-CaLxbxh3.js";import{r as _}from"./charts-BdICjjZY.js";import{c as O,A as b,f as Q,C as X,Z as q,h as k,D as M,G as U,l as Y,g as Z,T as J}from"./icons-CZRcmTJT.js";import"./vendor-Csw2ODfV.js";import"./router-M1Z-wYJt.js";const K="_dataLineage_55ln6_2",ee="_header_55ln6_9",se="_title_55ln6_13",te="_subtitle_55ln6_24",ne="_mainContent_55ln6_31",ie="_controls_55ln6_37",ae="_searchContainer_55ln6_49",ce="_searchIcon_55ln6_56",re="_searchInput_55ln6_66",le="_filterSelect_55ln6_87",oe="_clearButton_55ln6_104",de="_filterIndicator_55ln6_120",me="_clearFilterButton_55ln6_133",he="_contentGrid_55ln6_148",ue="_visualizationPanel_55ln6_155",xe="_legend_55ln6_164",_e="_legendItem_55ln6_176",fe="_legendDot_55ln6_185",ge="_source_55ln6_192",ye="_ingestion_55ln6_196",je="_transformation_55ln6_200",pe="_enrichment_55ln6_204",ve="_destination_55ln6_208",Ne="_lineageContainer_55ln6_212",Se="_lineageSvg_55ln6_220",Ce="_sectionLabel_55ln6_227",we="_nodeGroup_55ln6_234",Ie="_nodeRect_55ln6_239",$e="_selectedNode_55ln6_251",De="_nodeText_55ln6_257",Le="_nodeSubtext_55ln6_262",Pe="_connectionLine_55ln6_267",Te="_flowDot_55ln6_271",be="_tooltip_55ln6_276",ke="_sidePanel_55ln6_282",Me="_sidePanelHeader_55ln6_292",ze="_sidePanelTitle_55ln6_298",Ge="_statusBadge_55ln6_305",Ee="_statusHealthy_55ln6_314",Be="_statusWarning_55ln6_318",Ae="_statusFailed_55ln6_322",He="_statusProcessing_55ln6_326",Re="_sidePanelContent_55ln6_331",Ve="_detailSection_55ln6_340",We="_detailTitle_55ln6_346",Fe="_detailDescription_55ln6_355",Oe="_metricGrid_55ln6_362",Qe="_metric_55ln6_362",Xe="_metricValue_55ln6_383",qe="_metricLabel_55ln6_390",Ue="_connectionsList_55ln6_397",Ye="_connectionItem_55ln6_403",Ze="_connectionDot_55ln6_419",Je="_connectionName_55ln6_426",Ke="_connectionType_55ln6_433",es="_activityItem_55ln6_442",ss="_activityIcon_55ln6_452",ts="_activityText_55ln6_457",ns="_activityTime_55ln6_463",is="_summaryGrid_55ln6_469",as="_summaryCard_55ln6_476",cs="_summaryIcon_55ln6_493",rs="_summaryContent_55ln6_504",ls="_summaryValue_55ln6_508",os="_summaryLabel_55ln6_516",t={dataLineage:K,header:ee,title:se,subtitle:te,mainContent:ne,controls:ie,searchContainer:ae,searchIcon:ce,searchInput:re,filterSelect:le,clearButton:oe,filterIndicator:de,clearFilterButton:me,contentGrid:he,visualizationPanel:ue,legend:xe,legendItem:_e,legendDot:fe,source:ge,ingestion:ye,transformation:je,enrichment:pe,destination:ve,lineageContainer:Ne,lineageSvg:Se,sectionLabel:Ce,nodeGroup:we,nodeRect:Ie,selectedNode:$e,nodeText:De,nodeSubtext:Le,connectionLine:Pe,flowDot:Te,tooltip:be,sidePanel:ke,sidePanelHeader:Me,sidePanelTitle:ze,statusBadge:Ge,statusHealthy:Ee,statusWarning:Be,statusFailed:Ae,statusProcessing:He,sidePanelContent:Re,detailSection:Ve,detailTitle:We,detailDescription:Fe,metricGrid:Oe,metric:Qe,metricValue:Xe,metricLabel:qe,connectionsList:Ue,connectionItem:Ye,connectionDot:Ze,connectionName:Je,connectionType:Ke,activityItem:es,activityIcon:ss,activityText:ts,activityTime:ns,summaryGrid:is,summaryCard:as,summaryIcon:cs,summaryContent:rs,summaryValue:ls,summaryLabel:os},ds=_.memo(()=>{const[w,z]=_.useState(""),[h,N]=_.useState("all"),[m,I]=_.useState(null),[D,L]=_.useState(null),[v,S]=_.useState([]),G=_.useRef(null),u=s=>{let i=0;for(let c=0;c<s.length;c++){const l=s.charCodeAt(c);i=(i<<5)-i+l,i=i&i}return Math.abs(i)/2147483647},E=()=>{const s=[],i=[],c=["LinkedIn","Twitter","Office365","AzureAD","GitHub","ThreatIntel","Exchange","Teams","SharePoint","PowerBI"];return c.forEach((n,o)=>{const a=u(`${n}-status`),d=["healthy","warning","failed"],f=d[Math.floor(a*d.length)];s.push({id:`source-${n}`,name:n,type:"source",source:n,x:100,y:60+o*60,status:f,recordsPerSecond:Math.floor(u(`${n}-records`)*1e3)+100,avgProcessingTime:Math.floor(u(`${n}-time`)*500)+50,connections:[],description:`Data ingestion from ${n} platform`,lastUpdate:new Date(Date.now()-u(`${n}-update`)*36e5).toISOString(),dataQuality:Math.floor(u(`${n}-quality`)*20)+80})}),[{type:"ingestion",x:300},{type:"transformation",x:450},{type:"enrichment",x:600}].forEach(({type:n,x:o})=>{const a={};T.forEach(r=>{a[r.source]||(a[r.source]=[]),a[r.source].push(r)});const d=[];c.forEach(r=>{const g=a[r]||[];if(g.length>0){const F=Math.floor(u(`${n}-${r}`)*g.length);d.push(g[F])}});const f=d.map((r,g)=>({id:`${n}-${r.id}`,name:`${n.charAt(0).toUpperCase()+n.slice(1)} - ${r.name.split(" ").slice(0,3).join(" ")}`,type:n,source:r.source,x:o,y:60+g*60,status:r.status,recordsPerSecond:Math.floor(r.recordsProcessed/60),avgProcessingTime:r.avgProcessingTime,connections:[],description:`${n} pipeline: ${r.name}`,lastUpdate:r.lastRun.toISOString(),dataQuality:Math.floor(u(`${r.id}-quality`)*15)+85,actualPipeline:r}));s.push(...f)}),["MSTIC Data Lake","Threat Intelligence DB","Security Analytics Store","Alert System","ML Training Data","Compliance Archive","Real-time Dashboard","API Gateway"].forEach((n,o)=>{const a=u(`${n}-status`),d=["healthy","warning"],f=d[Math.floor(a*d.length)];s.push({id:`dest-${n}`,name:n,type:"destination",x:800,y:60+o*60,status:f,recordsPerSecond:Math.floor(u(`${n}-records`)*500)+50,avgProcessingTime:Math.floor(u(`${n}-time`)*100)+20,connections:[],description:`Data destination: ${n}`,lastUpdate:new Date(Date.now()-u(`${n}-update`)*18e5).toISOString(),dataQuality:Math.floor(u(`${n}-quality`)*10)+90})}),s.forEach(n=>{n.type==="source"?s.filter(a=>a.type==="ingestion"&&a.source===n.source).forEach(a=>{const d=`${n.id}-${a.id}`,f=u(`${d}-volume`),r=["low","medium","high"],g=r[Math.floor(f*r.length)];i.push({id:d,from:n.id,to:a.id,volume:g,health:n.status==="failed"?"error":n.status==="warning"?"warning":"healthy",animated:!0}),n.connections.push(a.id),a.connections.push(n.id)}):n.type==="ingestion"?s.filter(a=>a.type==="transformation"&&a.source===n.source).slice(0,2).forEach(a=>{const d=`${n.id}-${a.id}`,f=u(`${d}-volume`),r=["medium","high"],g=r[Math.floor(f*r.length)];i.push({id:d,from:n.id,to:a.id,volume:g,health:n.status==="failed"?"error":"healthy",animated:!0}),n.connections.push(a.id),a.connections.push(n.id)}):n.type==="transformation"?s.filter(a=>a.type==="enrichment"&&a.source===n.source).slice(0,2).forEach(a=>{const d=`${n.id}-${a.id}`;i.push({id:d,from:n.id,to:a.id,volume:"high",health:"healthy",animated:!0}),n.connections.push(a.id),a.connections.push(n.id)}):n.type==="enrichment"&&s.filter(a=>a.type==="destination").slice(0,3).forEach(a=>{const d=`${n.id}-${a.id}`;i.push({id:d,from:n.id,to:a.id,volume:"high",health:"healthy",animated:!0}),n.connections.push(a.id),a.connections.push(n.id)})}),{nodes:s,connections:i}},{nodes:y,connections:C}=_.useMemo(()=>E(),[]),B=_.useMemo(()=>h==="all"?C:C.filter(s=>{const i=y.find(l=>l.id===s.from),c=y.find(l=>l.id===s.to);return(i==null?void 0:i.source)===h||(c==null?void 0:c.source)===h?!0:(c==null?void 0:c.type)==="destination"?C.filter(x=>{var n;return x.to===c.id&&((n=y.find(o=>o.id===x.from))==null?void 0:n.type)==="enrichment"}).some(x=>{const n=y.find(o=>o.id===x.from);return(n==null?void 0:n.source)===h}):!1}),[y,C,h]),j=y,$=B;_.useEffect(()=>{S([]),I(null)},[h]);const p=j.filter(s=>s.name.toLowerCase().includes(w.toLowerCase())||s.source&&s.source.toLowerCase().includes(w.toLowerCase())),A=s=>{const i=new Set,c=[],l=x=>{if(i.has(x))return;i.add(x),c.push(x);const n=j.find(o=>o.id===x);n&&n.connections.forEach(o=>{i.has(o)||l(o)})};l(s),S(c)},H=s=>{I(s),s.type==="source"&&s.source?(N(s.source),S([])):A(s.id)},P=s=>{if(v.length>0&&!v.includes(s.id))return"#444";if(h!=="all"){if(s.type==="source"&&s.source===h)return"#0078d4";if(s.type==="source"&&s.source!==h)return"#333";if(s.type!=="source"&&s.type!=="destination")if(s.source===h)switch(s.type){case"ingestion":return"#52c41a";case"transformation":return"#faad14";case"enrichment":return"#8b5cf6";default:return"#888"}else return"#333";if(s.type==="destination")return $.some(c=>c.to===s.id)?"#ef4444":"#333"}switch(s.type){case"source":return"#0078d4";case"ingestion":return"#52c41a";case"transformation":return"#faad14";case"enrichment":return"#8b5cf6";case"destination":return"#ef4444";default:return"#888"}},R=s=>{const i=v.includes(s.from)&&v.includes(s.to);return{strokeWidth:s.volume==="high"?"3":s.volume==="medium"?"2":"1",stroke:s.health==="error"?"#ef4444":s.health==="warning"?"#faad14":"#52c41a",opacity:v.length>0?i?"1":"0.2":"0.8",strokeDasharray:s.volume==="low"?"5,5":"none",markerEnd:s.health==="error"?"url(#arrowhead-error)":s.health==="warning"?"url(#arrowhead-warning)":"url(#arrowhead-healthy)"}},V=s=>{switch(s){case"healthy":return e.jsx(k,{size:16,className:t.statusHealthy});case"warning":return e.jsx(J,{size:16,className:t.statusWarning});case"failed":return e.jsx(Z,{size:16,className:t.statusFailed});case"processing":return e.jsx(b,{size:16,className:t.statusProcessing});default:return null}},W=[...new Set(T.map(s=>s.source))];return e.jsxs("div",{className:t.dataLineage,children:[e.jsxs("div",{className:t.header,children:[e.jsx("h1",{className:t.title,children:"Interactive Data Lineage"}),e.jsx("p",{className:t.subtitle,children:"Visualize and explore data flow through your threat intelligence pipelines"})]}),e.jsxs("div",{className:t.mainContent,children:[e.jsxs("div",{className:t.controls,children:[e.jsxs("div",{className:t.searchContainer,children:[e.jsx(O,{className:t.searchIcon}),e.jsx("input",{type:"text",placeholder:"Search nodes and pipelines...",value:w,onChange:s=>z(s.target.value),className:t.searchInput})]}),e.jsxs("select",{value:h,onChange:s=>N(s.target.value),className:t.filterSelect,children:[e.jsx("option",{value:"all",children:"All Sources"}),W.map(s=>e.jsx("option",{value:s,children:s},s))]}),e.jsx("button",{className:t.clearButton,onClick:()=>{I(null),S([]),N("all")},children:"Clear Selection"})]}),h!=="all"&&e.jsxs("div",{className:t.filterIndicator,children:[e.jsxs("span",{children:["Showing data flow for: ",e.jsx("strong",{children:h})]}),e.jsx("button",{className:t.clearFilterButton,onClick:()=>N("all"),title:"Show all sources",children:"Ã—"})]}),e.jsxs("div",{className:t.contentGrid,children:[e.jsxs("div",{className:t.visualizationPanel,children:[e.jsxs("div",{className:t.legend,children:[e.jsxs("div",{className:t.legendItem,children:[e.jsx("div",{className:`${t.legendDot} ${t.source}`}),e.jsx("span",{children:"Data Sources"})]}),e.jsxs("div",{className:t.legendItem,children:[e.jsx("div",{className:`${t.legendDot} ${t.ingestion}`}),e.jsx("span",{children:"Ingestion"})]}),e.jsxs("div",{className:t.legendItem,children:[e.jsx("div",{className:`${t.legendDot} ${t.transformation}`}),e.jsx("span",{children:"Transformation"})]}),e.jsxs("div",{className:t.legendItem,children:[e.jsx("div",{className:`${t.legendDot} ${t.enrichment}`}),e.jsx("span",{children:"Enrichment"})]}),e.jsxs("div",{className:t.legendItem,children:[e.jsx("div",{className:`${t.legendDot} ${t.destination}`}),e.jsx("span",{children:"Destinations"})]})]}),e.jsx("div",{className:t.lineageContainer,children:e.jsxs("svg",{ref:G,className:t.lineageSvg,viewBox:"0 0 1000 800",preserveAspectRatio:"xMidYMid meet",children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"flowGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[e.jsx("stop",{offset:"0%",stopColor:"rgba(82, 196, 26, 0.1)"}),e.jsx("stop",{offset:"50%",stopColor:"rgba(82, 196, 26, 0.8)"}),e.jsx("stop",{offset:"100%",stopColor:"rgba(82, 196, 26, 0.1)"}),e.jsx("animateTransform",{attributeName:"gradientTransform",attributeType:"XML",type:"translate",values:"-100 0; 200 0; -100 0",dur:"3s",repeatCount:"indefinite"})]}),e.jsx("marker",{id:"arrowhead-healthy",markerWidth:"6",markerHeight:"4",refX:"5",refY:"2",orient:"auto",children:e.jsx("polygon",{points:"0 0, 6 2, 0 4",fill:"#52c41a"})}),e.jsx("marker",{id:"arrowhead-warning",markerWidth:"6",markerHeight:"4",refX:"5",refY:"2",orient:"auto",children:e.jsx("polygon",{points:"0 0, 6 2, 0 4",fill:"#faad14"})}),e.jsx("marker",{id:"arrowhead-error",markerWidth:"6",markerHeight:"4",refX:"5",refY:"2",orient:"auto",children:e.jsx("polygon",{points:"0 0, 6 2, 0 4",fill:"#ef4444"})}),e.jsxs("filter",{id:"glow",children:[e.jsx("feGaussianBlur",{stdDeviation:"3",result:"coloredBlur"}),e.jsxs("feMerge",{children:[e.jsx("feMergeNode",{in:"coloredBlur"}),e.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),e.jsx("text",{x:"170",y:"30",className:t.sectionLabel,children:"Data Sources"}),e.jsx("text",{x:"370",y:"30",className:t.sectionLabel,children:"Ingestion"}),e.jsx("text",{x:"520",y:"30",className:t.sectionLabel,children:"Transformation"}),e.jsx("text",{x:"670",y:"30",className:t.sectionLabel,children:"Enrichment"}),e.jsx("text",{x:"870",y:"30",className:t.sectionLabel,children:"Destinations"}),$.filter(s=>{const i=p.find(l=>l.id===s.from),c=p.find(l=>l.id===s.to);return i&&c}).map(s=>{const i=p.find(x=>x.id===s.from),c=p.find(x=>x.id===s.to),l=R(s);return e.jsxs("g",{children:[e.jsx("line",{x1:i.x+140,y1:i.y+20,x2:c.x,y2:c.y+20,stroke:l.stroke,strokeWidth:l.strokeWidth,opacity:l.opacity,strokeDasharray:l.strokeDasharray,markerEnd:l.markerEnd,className:t.connectionLine}),s.animated&&e.jsx("circle",{r:"3",fill:l.stroke,className:t.flowDot,children:e.jsx("animateMotion",{dur:"3s",repeatCount:"indefinite",path:`M${i.x+140},${i.y+20} L${c.x},${c.y+20}`})})]},s.id)}),p.map(s=>{const i=s.type==="source"&&h!=="all"&&s.source===h;return e.jsxs("g",{className:t.nodeGroup,onClick:()=>H(s),onMouseEnter:()=>L(s.id),onMouseLeave:()=>L(null),children:[e.jsx("rect",{x:s.x,y:s.y,width:"140",height:"40",fill:P(s),rx:"6",className:`${t.nodeRect} ${(m==null?void 0:m.id)===s.id?t.selectedNode:""}`,filter:(m==null?void 0:m.id)===s.id||i?"url(#glow)":"none",stroke:i?"#ffffff":"transparent",strokeWidth:i?"2":"0"}),e.jsx("text",{x:s.x+70,y:s.y+16,textAnchor:"middle",fill:"white",fontSize:"10",fontWeight:"600",className:t.nodeText,children:s.name.length>16?`${s.name.substring(0,13)}...`:s.name}),e.jsxs("text",{x:s.x+70,y:s.y+30,textAnchor:"middle",fill:"rgba(255,255,255,0.8)",fontSize:"8",className:t.nodeSubtext,children:[s.recordsPerSecond,"/s"]}),e.jsx("circle",{cx:s.x+125,cy:s.y+10,r:"4",fill:s.status==="healthy"?"#52c41a":s.status==="warning"?"#faad14":s.status==="failed"?"#ef4444":"#1890ff"})]},s.id)}),D&&p.map(s=>{if(D!==s.id)return null;const i=s.x>600?s.x-210:s.x+150,c=s.y-10;return e.jsxs("g",{className:t.tooltip,children:[e.jsx("rect",{x:i,y:c,width:"200",height:"60",fill:"rgba(0,0,0,0.95)",rx:"6",stroke:"#555",strokeWidth:"1"}),e.jsx("text",{x:i+10,y:c+15,fill:"white",fontSize:"11",fontWeight:"600",children:s.name}),e.jsxs("text",{x:i+10,y:c+28,fill:"#ccc",fontSize:"9",children:["Records/sec: ",s.recordsPerSecond]}),e.jsxs("text",{x:i+10,y:c+40,fill:"#ccc",fontSize:"9",children:["Avg Time: ",s.avgProcessingTime,"ms"]}),e.jsxs("text",{x:i+10,y:c+52,fill:"#ccc",fontSize:"9",children:["Quality: ",s.dataQuality,"%"]})]},`tooltip-${s.id}`)})]})})]}),m&&e.jsxs("div",{className:t.sidePanel,children:[e.jsxs("div",{className:t.sidePanelHeader,children:[e.jsx("h3",{className:t.sidePanelTitle,children:m.name}),e.jsxs("div",{className:t.statusBadge,children:[V(m.status),e.jsx("span",{children:m.status})]})]}),e.jsxs("div",{className:t.sidePanelContent,children:[e.jsxs("div",{className:t.detailSection,children:[e.jsx("h4",{className:t.detailTitle,children:"Overview"}),e.jsx("p",{className:t.detailDescription,children:m.description}),e.jsxs("div",{className:t.metricGrid,children:[e.jsxs("div",{className:t.metric,children:[e.jsx(b,{size:16}),e.jsxs("div",{children:[e.jsxs("div",{className:t.metricValue,children:[m.recordsPerSecond,"/s"]}),e.jsx("div",{className:t.metricLabel,children:"Records per second"})]})]}),e.jsxs("div",{className:t.metric,children:[e.jsx(Q,{size:16}),e.jsxs("div",{children:[e.jsxs("div",{className:t.metricValue,children:[m.avgProcessingTime,"ms"]}),e.jsx("div",{className:t.metricLabel,children:"Avg processing time"})]})]}),e.jsxs("div",{className:t.metric,children:[e.jsx(X,{size:16}),e.jsxs("div",{children:[e.jsxs("div",{className:t.metricValue,children:[m.dataQuality,"%"]}),e.jsx("div",{className:t.metricLabel,children:"Data quality"})]})]}),e.jsxs("div",{className:t.metric,children:[e.jsx(q,{size:16}),e.jsxs("div",{children:[e.jsx("div",{className:t.metricValue,children:m.connections.length}),e.jsx("div",{className:t.metricLabel,children:"Connections"})]})]})]})]}),e.jsxs("div",{className:t.detailSection,children:[e.jsx("h4",{className:t.detailTitle,children:"Connected Pipelines"}),e.jsx("div",{className:t.connectionsList,children:m.connections.slice(0,5).map(s=>{const i=j.find(c=>c.id===s);return i?e.jsxs("div",{className:t.connectionItem,children:[e.jsx("div",{className:t.connectionDot,style:{backgroundColor:P(i)}}),e.jsx("span",{className:t.connectionName,children:i.name}),e.jsx("span",{className:t.connectionType,children:i.type})]},s):null})})]}),e.jsxs("div",{className:t.detailSection,children:[e.jsx("h4",{className:t.detailTitle,children:"Recent Activity"}),e.jsxs("div",{className:t.activityItem,children:[e.jsx("div",{className:t.activityIcon,children:e.jsx(k,{size:14})}),e.jsxs("div",{children:[e.jsx("div",{className:t.activityText,children:"Last updated"}),e.jsx("div",{className:t.activityTime,children:new Date(m.lastUpdate).toLocaleString()})]})]})]})]})]})]})]}),e.jsxs("div",{className:t.summaryGrid,children:[e.jsxs("div",{className:t.summaryCard,children:[e.jsx("div",{className:t.summaryIcon,children:e.jsx(M,{size:24})}),e.jsxs("div",{className:t.summaryContent,children:[e.jsx("div",{className:t.summaryValue,children:j.filter(s=>s.type==="source").length}),e.jsx("div",{className:t.summaryLabel,children:"Data Sources"})]})]}),e.jsxs("div",{className:t.summaryCard,children:[e.jsx("div",{className:t.summaryIcon,children:e.jsx(U,{size:24})}),e.jsxs("div",{className:t.summaryContent,children:[e.jsx("div",{className:t.summaryValue,children:j.filter(s=>["ingestion","transformation","enrichment"].includes(s.type)).length}),e.jsx("div",{className:t.summaryLabel,children:"Processing Pipelines"})]})]}),e.jsxs("div",{className:t.summaryCard,children:[e.jsx("div",{className:t.summaryIcon,children:e.jsx(Y,{size:24})}),e.jsxs("div",{className:t.summaryContent,children:[e.jsx("div",{className:t.summaryValue,children:$.length}),e.jsx("div",{className:t.summaryLabel,children:"Data Flows"})]})]}),e.jsxs("div",{className:t.summaryCard,children:[e.jsx("div",{className:t.summaryIcon,children:e.jsx(M,{size:24})}),e.jsxs("div",{className:t.summaryContent,children:[e.jsx("div",{className:t.summaryValue,children:j.filter(s=>s.type==="destination").length}),e.jsx("div",{className:t.summaryLabel,children:"Destinations"})]})]})]})]})});ds.displayName="DataLineage";export{ds as default};
//# sourceMappingURL=DataLineage-BXYYeMkw.js.map
