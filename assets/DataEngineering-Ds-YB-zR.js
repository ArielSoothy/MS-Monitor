import{j as e}from"./index-BP8q5Izt.js";import{r as s}from"./charts-DwVu4C-4.js";import{H as B}from"./HowItWorksModal-CElEZR-v.js";import{C as E}from"./ChallengesModal-XxEpkmUu.js";import{D as d,i as A,S as P,P as O,q as T,R as h,b as H,a0 as F,H as L,Z as U,B as _,p as x,a as Q,C as G,n as v,T as $}from"./icons-DTFXYCiL.js";import"./vendor-Csw2ODfV.js";import"./router-Uvrq3glh.js";const V="_dataEngineeringPage_1ta01_1",W="_header_1ta01_9",Z="_titleSection_1ta01_18",J="_titleIcon_1ta01_24",K="_infoButton_1ta01_38",X="_challengesButton_1ta01_59",Y="_controls_1ta01_73",ee="_controlButton_1ta01_79",te="_active_1ta01_98",ie="_loadingContainer_1ta01_104",se="_loadingIcon_1ta01_114",ae="_spinning_1ta01_123",ne="_pipelineSection_1ta01_128",oe="_pipelineFlow_1ta01_139",re="_pipelineStageContainer_1ta01_147",ce="_pipelineStage_1ta01_147",le="_stageHeader_1ta01_169",de="_stageStatus_1ta01_176",me="_stageType_1ta01_184",pe="_stageName_1ta01_195",ue="_stageMetrics_1ta01_203",ge="_stageMetric_1ta01_203",he="_resourceUsage_1ta01_226",_e="_resourceMetric_1ta01_236",xe="_optimizations_1ta01_248",ve="_optimization_1ta01_248",je="_moreOptimizations_1ta01_267",ye="_pipelineArrow_1ta01_274",fe="_qualitySection_1ta01_280",ze="_qualityGrid_1ta01_291",Se="_qualityCard_1ta01_297",Ne="_qualityHeader_1ta01_311",Ie="_impactBadge_1ta01_326",Ce="_qualityDescription_1ta01_338",we="_qualityMetrics_1ta01_345",ke="_qualityMetric_1ta01_345",qe="_passRate_1ta01_367",Re="_failedRecords_1ta01_372",Me="_suggestions_1ta01_377",be="_suggestion_1ta01_377",De="_optimizationSection_1ta01_410",Be="_optimizationGrid_1ta01_421",Ee="_optimizationCard_1ta01_427",Ae="_selected_1ta01_442",Pe="_optimizationHeader_1ta01_447",Oe="_categoryBadge_1ta01_454",Te="_effortRisk_1ta01_465",He="_effort_1ta01_465",Fe="_risk_1ta01_477",Le="_improvements_1ta01_495",Ue="_improvement_1ta01_495",Qe="_optimizationDetail_1ta01_515",Ge="_optimizationComparison_1ta01_532",$e="_currentState_1ta01_539",Ve="_optimizedState_1ta01_540",We="_transitionArrow_1ta01_570",t={dataEngineeringPage:V,header:W,titleSection:Z,titleIcon:J,infoButton:K,challengesButton:X,controls:Y,controlButton:ee,active:te,loadingContainer:ie,loadingIcon:se,spinning:ae,pipelineSection:ne,pipelineFlow:oe,pipelineStageContainer:re,pipelineStage:ce,stageHeader:le,stageStatus:de,stageType:me,stageName:pe,stageMetrics:ue,stageMetric:ge,resourceUsage:he,resourceMetric:_e,optimizations:xe,optimization:ve,moreOptimizations:je,pipelineArrow:ye,qualitySection:fe,qualityGrid:ze,qualityCard:Se,qualityHeader:Ne,impactBadge:Ie,qualityDescription:Ce,qualityMetrics:we,qualityMetric:ke,passRate:qe,failedRecords:Re,suggestions:Me,suggestion:be,optimizationSection:De,optimizationGrid:Be,optimizationCard:Ee,selected:Ae,optimizationHeader:Pe,categoryBadge:Oe,effortRisk:Te,effort:He,risk:Fe,improvements:Le,improvement:Ue,optimizationDetail:Qe,optimizationComparison:Ge,currentState:$e,optimizedState:Ve,transitionArrow:We},it=()=>{const[m,j]=s.useState([]),[y,f]=s.useState([]),[z,S]=s.useState([]),[N,I]=s.useState([]),[r,C]=s.useState(null),[w,p]=s.useState(!0),[n,k]=s.useState(!0),[q,u]=s.useState(!1),[R,g]=s.useState(!1);s.useEffect(()=>{if(l(),n){const i=setInterval(l,5e3);return()=>clearInterval(i)}},[n]);const l=async()=>{try{p(!0);const i=[{stageId:"stage-001",name:"Azure AD Log Ingestion",type:"ingestion",status:"running",duration:2847,recordsIn:0,recordsOut:2847592,dataQuality:98.7,resourceUsage:{cpu:23.4,memory:67.8,disk:12.3},optimizations:["Columnar storage format (Parquet)","Compression with Snappy codec","Parallel ingestion with 8 threads"],dependencies:[]},{stageId:"stage-002",name:"Schema Validation & Normalization",type:"validation",status:"completed",duration:1834,recordsIn:2847592,recordsOut:2834156,dataQuality:99.5,resourceUsage:{cpu:45.2,memory:89.3,disk:34.7},optimizations:["Schema registry for validation","Vectorized processing","Bloom filters for fast lookups"],dependencies:["stage-001"]},{stageId:"stage-003",name:"Threat Intelligence Enrichment",type:"enrichment",status:"running",duration:4721,recordsIn:2834156,recordsOut:2834156,dataQuality:96.2,resourceUsage:{cpu:67.9,memory:78.4,disk:45.6},optimizations:["In-memory lookup tables","Distributed hash joins","Adaptive query execution"],dependencies:["stage-002"]},{stageId:"stage-004",name:"Risk Score Calculation",type:"transformation",status:"waiting",duration:0,recordsIn:0,recordsOut:0,dataQuality:0,resourceUsage:{cpu:0,memory:0,disk:0},optimizations:["Vectorized calculations","Model caching","Batch prediction optimization"],dependencies:["stage-003"]},{stageId:"stage-005",name:"Aggregation & Windowing",type:"aggregation",status:"waiting",duration:0,recordsIn:0,recordsOut:0,dataQuality:0,resourceUsage:{cpu:0,memory:0,disk:0},optimizations:["Tumbling windows (5-minute)","Pre-aggregated materialized views","Delta Lake ACID transactions"],dependencies:["stage-004"]}],a=[{ruleName:"IP Address Format Validation",description:"Ensures all IP addresses follow IPv4/IPv6 format standards",passRate:99.97,failedRecords:847,impact:"medium",suggestions:["Implement regex validation at ingestion","Add data quality monitoring alerts","Create quarantine table for invalid IPs"]},{ruleName:"Timestamp Consistency Check",description:"Validates timestamp formats and ranges across all events",passRate:98.42,failedRecords:44832,impact:"high",suggestions:["Standardize timezone handling","Implement timestamp normalization","Add temporal data validation rules"]},{ruleName:"User ID Completeness",description:"Ensures all security events have valid user identifiers",passRate:96.8,failedRecords:90876,impact:"critical",suggestions:["Implement user ID lookup service","Add default values for system accounts","Create user identity resolution pipeline"]},{ruleName:"Geolocation Data Accuracy",description:"Validates IP-to-location mapping accuracy and completeness",passRate:94.3,failedRecords:161847,impact:"medium",suggestions:["Update GeoIP database monthly","Implement fallback geolocation services","Add confidence scores to location data"]}],c=[{category:"partitioning",name:"Time-based Data Partitioning",description:"Implement daily partitioning strategy for security events table",currentState:"Single large table with 2.8B rows",optimizedState:"Daily partitions with automatic pruning",expectedImprovement:{queryTime:75,storageReduction:15,costSavings:40},implementationEffort:"medium",riskLevel:"low"},{category:"indexing",name:"Composite Index Optimization",description:"Create optimal indexes for common query patterns",currentState:"Basic clustered index on timestamp",optimizedState:"Composite indexes on (timestamp, user_id, threat_level)",expectedImprovement:{queryTime:85,storageReduction:-5,costSavings:25},implementationEffort:"low",riskLevel:"low"},{category:"compression",name:"Advanced Compression Strategy",description:"Implement columnar compression with adaptive encoding",currentState:"Row-based storage with basic compression",optimizedState:"Columnar format with adaptive compression",expectedImprovement:{queryTime:45,storageReduction:60,costSavings:55},implementationEffort:"high",riskLevel:"medium"},{category:"caching",name:"Intelligent Query Result Caching",description:"Implement semantic caching for frequent analytical queries",currentState:"No query result caching",optimizedState:"Multi-level caching with TTL and invalidation",expectedImprovement:{queryTime:90,storageReduction:0,costSavings:35},implementationEffort:"medium",riskLevel:"low"},{category:"parallelization",name:"Adaptive Query Parallelization",description:"Dynamic parallelization based on query complexity and data size",currentState:"Fixed parallelism settings",optimizedState:"Adaptive parallelism with cost-based optimization",expectedImprovement:{queryTime:65,storageReduction:0,costSavings:20},implementationEffort:"high",riskLevel:"medium"}],o=[{version:"v2.3.0",timestamp:new Date(Date.now()-864e5),changes:[{type:"added",field:"threat_confidence_score",description:"Added ML-based confidence scoring for threat detection",impact:"non-breaking"},{type:"modified",field:"user_risk_level",description:'Expanded enum values to include "very_high" risk level',impact:"non-breaking"}],compatibility:"backward",migrationRequired:!1},{version:"v2.2.1",timestamp:new Date(Date.now()-2592e5),changes:[{type:"deprecated",field:"legacy_event_type",description:"Deprecated in favor of standardized event_category field",impact:"non-breaking"}],compatibility:"full",migrationRequired:!1}];j(i),f(a),I(c),S(o),console.log("Schema evolution data loaded:",o.length,"entries")}catch(i){console.error("Failed to load data engineering metrics:",i)}finally{p(!1)}},M=i=>{switch(i){case"completed":return"#10b981";case"running":return"#3b82f6";case"failed":return"#ef4444";case"waiting":return"#6b7280";default:return"#6b7280"}},b=i=>{switch(i){case"completed":return e.jsx(x,{size:16});case"running":return e.jsx(h,{size:16,className:t.spinning});case"failed":return e.jsx($,{size:16});case"waiting":return e.jsx(v,{size:16});default:return e.jsx(v,{size:16})}},D=i=>{switch(i){case"low":return"#10b981";case"medium":return"#f59e0b";case"high":return"#ef4444";case"critical":return"#dc2626";default:return"#6b7280"}};return w?e.jsxs("div",{className:t.loadingContainer,children:[e.jsx(d,{className:t.loadingIcon}),e.jsx("span",{children:"Loading data engineering metrics..."})]}):e.jsxs("div",{className:t.dataEngineeringPage,children:[e.jsxs("div",{className:t.header,children:[e.jsxs("div",{className:t.titleSection,children:[e.jsx(d,{className:t.titleIcon}),e.jsxs("div",{children:[e.jsxs("h1",{children:["Data Engineering Excellence",e.jsx("button",{className:t.infoButton,onClick:()=>u(!0),title:"How does this system work?",children:e.jsx(A,{size:18})}),e.jsx("button",{className:`${t.infoButton} ${t.challengesButton}`,onClick:()=>g(!0),title:"Implementation Challenges",children:e.jsx(P,{size:18})})]}),e.jsx("p",{children:"Advanced pipeline optimization, data quality monitoring, and schema evolution"})]})]}),e.jsxs("div",{className:t.controls,children:[e.jsxs("button",{className:`${t.controlButton} ${n?t.active:""}`,onClick:()=>k(!n),children:[n?e.jsx(O,{size:16}):e.jsx(T,{size:16}),n?"Pause":"Resume"," Real-time"]}),e.jsxs("button",{className:t.controlButton,onClick:l,children:[e.jsx(h,{size:16}),"Refresh"]})]})]}),e.jsxs("div",{className:t.pipelineSection,children:[e.jsx("h2",{children:"Data Pipeline Flow"}),e.jsx("div",{className:t.pipelineFlow,children:m.map((i,a)=>e.jsxs("div",{className:t.pipelineStageContainer,children:[e.jsxs("div",{className:t.pipelineStage,children:[e.jsxs("div",{className:t.stageHeader,children:[e.jsxs("div",{className:t.stageStatus,style:{color:M(i.status)},children:[b(i.status),e.jsx("span",{children:i.status})]}),e.jsx("span",{className:t.stageType,children:i.type})]}),e.jsx("h4",{className:t.stageName,children:i.name}),e.jsxs("div",{className:t.stageMetrics,children:[e.jsxs("div",{className:t.stageMetric,children:[e.jsx("span",{children:"Duration"}),e.jsx("span",{children:i.duration>0?`${(i.duration/1e3).toFixed(1)}s`:"-"})]}),e.jsxs("div",{className:t.stageMetric,children:[e.jsx("span",{children:"Records In"}),e.jsx("span",{children:i.recordsIn>0?i.recordsIn.toLocaleString():"-"})]}),e.jsxs("div",{className:t.stageMetric,children:[e.jsx("span",{children:"Records Out"}),e.jsx("span",{children:i.recordsOut>0?i.recordsOut.toLocaleString():"-"})]}),e.jsxs("div",{className:t.stageMetric,children:[e.jsx("span",{children:"Quality"}),e.jsx("span",{children:i.dataQuality>0?`${i.dataQuality.toFixed(1)}%`:"-"})]})]}),i.status==="running"&&e.jsxs("div",{className:t.resourceUsage,children:[e.jsxs("div",{className:t.resourceMetric,children:[e.jsx(H,{size:14}),e.jsxs("span",{children:[i.resourceUsage.cpu.toFixed(1),"%"]})]}),e.jsxs("div",{className:t.resourceMetric,children:[e.jsx(F,{size:14}),e.jsxs("span",{children:[i.resourceUsage.memory.toFixed(1),"%"]})]}),e.jsxs("div",{className:t.resourceMetric,children:[e.jsx(L,{size:14}),e.jsxs("span",{children:[i.resourceUsage.disk.toFixed(1),"%"]})]})]}),e.jsxs("div",{className:t.optimizations,children:[i.optimizations.slice(0,2).map((c,o)=>e.jsxs("div",{className:t.optimization,children:[e.jsx(U,{size:12}),e.jsx("span",{children:c})]},o)),i.optimizations.length>2&&e.jsxs("div",{className:t.moreOptimizations,children:["+",i.optimizations.length-2," more"]})]})]}),a<m.length-1&&e.jsx(_,{className:t.pipelineArrow})]},i.stageId))})]}),e.jsxs("div",{className:t.qualitySection,children:[e.jsx("h2",{children:"Data Quality Monitoring"}),e.jsx("div",{className:t.qualityGrid,children:y.map((i,a)=>e.jsxs("div",{className:t.qualityCard,children:[e.jsxs("div",{className:t.qualityHeader,children:[e.jsx("h4",{children:i.ruleName}),e.jsx("div",{className:t.impactBadge,style:{color:D(i.impact)},children:i.impact})]}),e.jsx("p",{className:t.qualityDescription,children:i.description}),e.jsxs("div",{className:t.qualityMetrics,children:[e.jsxs("div",{className:t.qualityMetric,children:[e.jsx("span",{children:"Pass Rate"}),e.jsxs("span",{className:t.passRate,children:[i.passRate.toFixed(2),"%"]})]}),e.jsxs("div",{className:t.qualityMetric,children:[e.jsx("span",{children:"Failed Records"}),e.jsx("span",{className:t.failedRecords,children:i.failedRecords.toLocaleString()})]})]}),e.jsxs("div",{className:t.suggestions,children:[e.jsx("h5",{children:"Improvement Suggestions:"}),i.suggestions.map((c,o)=>e.jsxs("div",{className:t.suggestion,children:[e.jsx(x,{size:12}),e.jsx("span",{children:c})]},o))]})]},a))})]}),e.jsxs("div",{className:t.optimizationSection,children:[e.jsx("h2",{children:"Performance Optimization Opportunities"}),e.jsx("div",{className:t.optimizationGrid,children:N.map((i,a)=>e.jsxs("div",{className:`${t.optimizationCard} ${r===i?t.selected:""}`,onClick:()=>C(i),children:[e.jsxs("div",{className:t.optimizationHeader,children:[e.jsx("div",{className:t.categoryBadge,children:i.category}),e.jsxs("div",{className:t.effortRisk,children:[e.jsxs("span",{className:t.effort,children:["Effort: ",i.implementationEffort]}),e.jsxs("span",{className:t.risk,children:["Risk: ",i.riskLevel]})]})]}),e.jsx("h4",{children:i.name}),e.jsx("p",{children:i.description}),e.jsxs("div",{className:t.improvements,children:[e.jsxs("div",{className:t.improvement,children:[e.jsx(Q,{size:14}),e.jsxs("span",{children:["Query Time: ",i.expectedImprovement.queryTime,"% faster"]})]}),e.jsxs("div",{className:t.improvement,children:[e.jsx(d,{size:14}),e.jsxs("span",{children:["Storage: ",i.expectedImprovement.storageReduction,"% reduction"]})]}),e.jsxs("div",{className:t.improvement,children:[e.jsx(G,{size:14}),e.jsxs("span",{children:["Cost: ",i.expectedImprovement.costSavings,"% savings"]})]})]})]},a))})]}),r&&e.jsxs("div",{className:t.optimizationDetail,children:[e.jsxs("h3",{children:["Optimization Details: ",r.name]}),e.jsxs("div",{className:t.optimizationComparison,children:[e.jsxs("div",{className:t.currentState,children:[e.jsx("h4",{children:"Current State"}),e.jsx("p",{children:r.currentState})]}),e.jsx(_,{className:t.transitionArrow}),e.jsxs("div",{className:t.optimizedState,children:[e.jsx("h4",{children:"Optimized State"}),e.jsx("p",{children:r.optimizedState})]})]})]}),e.jsx("div",{style:{display:"none"},children:z.length}),e.jsx(B,{isOpen:q,onClose:()=>u(!1),section:"dataEngineering"}),e.jsx(E,{isOpen:R,onClose:()=>g(!1),section:"dataEngineering"})]})};export{it as default};
//# sourceMappingURL=DataEngineering-Ds-YB-zR.js.map
