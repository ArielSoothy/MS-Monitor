import{j as e,m as W}from"./index-ProU9vnd.js";import{r as k}from"./charts-BdICjjZY.js";import{g as ee,A as O,E as U,l as X,M as re,U as F,m as K,h as H,n as Y,k as Z,f as Q,T as te,Z as se,c as ce,C as oe,D as J,G as le,o as de}from"./icons-C8yFdGjp.js";import"./vendor-Csw2ODfV.js";import"./router-M1Z-wYJt.js";const me="_modalOverlay_1k7nf_2",he="_modal_1k7nf_2",ue="_modalHeader_1k7nf_29",_e="_modalTitle_1k7nf_38",xe="_pipelineName_1k7nf_45",fe="_closeButton_1k7nf_52",pe="_quickActions_1k7nf_68",ye="_actionButton_1k7nf_77",je="_tabNav_1k7nf_102",ge="_tab_1k7nf_102",ve="_activeTab_1k7nf_128",Ne="_errorBadge_1k7nf_134",ke="_modalContent_1k7nf_144",we="_tabContent_1k7nf_150",Ce="_currentError_1k7nf_155",Se="_errorHeader_1k7nf_163",be="_errorInfo_1k7nf_170",Ie="_errorIcon_1k7nf_176",Te="_errorTitle_1k7nf_182",De="_errorMeta_1k7nf_190",Le="_errorCode_1k7nf_196",Me="_errorTime_1k7nf_202",Be="_severityBadge_1k7nf_207",Pe="_stackTrace_1k7nf_217",Ae="_stackHeader_1k7nf_221",$e="_copyButton_1k7nf_234",He="_stackContent_1k7nf_252",ze="_suggestedActions_1k7nf_266",Ee="_actionsList_1k7nf_276",Ge="_actionItem_1k7nf_282",Re="_actionIcon_1k7nf_291",qe="_context_1k7nf_298",Oe="_contextGrid_1k7nf_308",Ve="_contextItem_1k7nf_314",We="_contextKey_1k7nf_324",Ue="_contextValue_1k7nf_331",Fe="_noError_1k7nf_339",Qe="_noErrorIcon_1k7nf_345",Xe="_errorHistory_1k7nf_357",Ke="_historyList_1k7nf_367",Ye="_historyItem_1k7nf_373",Ze="_historyIcon_1k7nf_388",Je="_historyContent_1k7nf_393",et="_historyMessage_1k7nf_397",tt="_historyMeta_1k7nf_403",st="_historySeverity_1k7nf_410",at="_logsSection_1k7nf_420",it="_logsList_1k7nf_426",nt="_logItem_1k7nf_432",rt="_logHeader_1k7nf_439",ct="_logSystem_1k7nf_446",ot="_logButton_1k7nf_455",lt="_logMeta_1k7nf_473",dt="_queryTemplate_1k7nf_482",mt="_queryHeader_1k7nf_486",ht="_queryCode_1k7nf_499",ut="_metricsSection_1k7nf_512",_t="_metricsPlaceholder_1k7nf_518",xt="_metricsInfo_1k7nf_537",ft="_grafanaButton_1k7nf_543",pt="_impactSection_1k7nf_564",yt="_impactOverview_1k7nf_570",jt="_impactLevel_1k7nf_577",gt="_impactBadge_1k7nf_582",vt="_impactGrid_1k7nf_592",Nt="_impactCard_1k7nf_598",kt="_affectedList_1k7nf_611",wt="_affectedItem_1k7nf_617",Ct="_impactMetric_1k7nf_630",St="_noImpact_1k7nf_636",bt="_runbooksSection_1k7nf_654",It="_runbooksList_1k7nf_660",Tt="_runbookItem_1k7nf_667",Dt="_runbookHeader_1k7nf_674",Lt="_runbookMeta_1k7nf_687",Mt="_runbookDescription_1k7nf_695",Bt="_runbookButton_1k7nf_701",Pt="_oncallInfo_1k7nf_720",At="_oncallDetails_1k7nf_731",a={modalOverlay:me,modal:he,modalHeader:ue,modalTitle:_e,pipelineName:xe,closeButton:fe,quickActions:pe,actionButton:ye,tabNav:je,tab:ge,activeTab:ve,errorBadge:Ne,modalContent:ke,tabContent:we,currentError:Ce,errorHeader:Se,errorInfo:be,errorIcon:Ie,errorTitle:Te,errorMeta:De,errorCode:Le,errorTime:Me,severityBadge:Be,stackTrace:Pe,stackHeader:Ae,copyButton:$e,stackContent:He,suggestedActions:ze,actionsList:Ee,actionItem:Ge,actionIcon:Re,context:qe,contextGrid:Oe,contextItem:Ve,contextKey:We,contextValue:Ue,noError:Fe,noErrorIcon:Qe,errorHistory:Xe,historyList:Ke,historyItem:Ye,historyIcon:Ze,historyContent:Je,historyMessage:et,historyMeta:tt,historySeverity:st,logsSection:at,logsList:it,logItem:nt,logHeader:rt,logSystem:ct,logButton:ot,logMeta:lt,queryTemplate:dt,queryHeader:mt,queryCode:ht,metricsSection:ut,metricsPlaceholder:_t,metricsInfo:xt,grafanaButton:ft,impactSection:pt,impactOverview:yt,impactLevel:jt,impactBadge:gt,impactGrid:vt,impactCard:Nt,affectedList:kt,affectedItem:wt,impactMetric:Ct,noImpact:St,runbooksSection:bt,runbooksList:It,runbookItem:Tt,runbookHeader:Dt,runbookMeta:Lt,runbookDescription:Mt,runbookButton:Bt,oncallInfo:Pt,oncallDetails:At},$t=({isOpen:P,onClose:z,pipelineName:p,currentError:_,errorHistory:o,logReferences:I,metricsHistory:T,impactAnalysis:w,runbooks:b,oncallTeam:D,slackChannel:A,teamsChannel:$,dashboardUrl:E,grafanaUrl:f,healthCheckUrl:G})=>{const[N,L]=k.useState("error"),[R,C]=k.useState(null);if(!P)return null;const M=async(r,y)=>{try{await navigator.clipboard.writeText(r),C(y),setTimeout(()=>C(null),2e3)}catch(q){console.error("Failed to copy:",q)}},S=r=>{switch(r){case"connection":return e.jsx(se,{className:a.errorIcon});case"data_quality":return e.jsx(X,{className:a.errorIcon});case"timeout":return e.jsx(Q,{className:a.errorIcon});case"authentication":return e.jsx(F,{className:a.errorIcon});default:return e.jsx(te,{className:a.errorIcon})}},B=r=>{switch(r){case"critical":return"#ef4444";case"high":return"#f97316";case"medium":return"#eab308";case"low":return"#22c55e";default:return"#6b7280"}};return e.jsx("div",{className:a.modalOverlay,onClick:z,children:e.jsxs("div",{className:a.modal,onClick:r=>r.stopPropagation(),children:[e.jsxs("div",{className:a.modalHeader,children:[e.jsxs("div",{children:[e.jsx("h2",{className:a.modalTitle,children:"Pipeline Error Details"}),e.jsx("p",{className:a.pipelineName,children:p})]}),e.jsx("button",{className:a.closeButton,onClick:z,children:e.jsx(ee,{size:24})})]}),e.jsxs("div",{className:a.quickActions,children:[e.jsxs("button",{className:a.actionButton,onClick:()=>window.open(G,"_blank"),disabled:!G,children:[e.jsx(O,{size:16}),"Health Check"]}),e.jsxs("button",{className:a.actionButton,onClick:()=>window.open(E,"_blank"),disabled:!E,children:[e.jsx(U,{size:16}),"Dashboard"]}),e.jsxs("button",{className:a.actionButton,onClick:()=>window.open(f,"_blank"),disabled:!f,children:[e.jsx(X,{size:16}),"Metrics"]}),A&&e.jsxs("button",{className:a.actionButton,onClick:()=>window.open(`slack://channel?team=T123&id=${A}`,"_blank"),children:[e.jsx(re,{size:16}),"Slack"]}),$&&e.jsxs("button",{className:a.actionButton,onClick:()=>window.open($,"_blank"),children:[e.jsx(F,{size:16}),"Teams"]})]}),e.jsx("div",{className:a.tabNav,children:["error","logs","metrics","impact","runbooks"].map(r=>e.jsxs("button",{className:`${a.tab} ${N===r?a.activeTab:""}`,onClick:()=>L(r),children:[r.charAt(0).toUpperCase()+r.slice(1),r==="error"&&_&&e.jsx("span",{className:a.errorBadge,style:{backgroundColor:B(_.severity)},children:_.severity})]},r))}),e.jsxs("div",{className:a.modalContent,children:[N==="error"&&e.jsxs("div",{className:a.tabContent,children:[_?e.jsxs("div",{className:a.currentError,children:[e.jsxs("div",{className:a.errorHeader,children:[e.jsxs("div",{className:a.errorInfo,children:[S(_.errorType),e.jsxs("div",{children:[e.jsx("h3",{className:a.errorTitle,children:_.errorMessage}),e.jsxs("div",{className:a.errorMeta,children:[e.jsxs("span",{className:a.errorCode,children:["Error Code: ",_.errorCode]}),e.jsx("span",{className:a.errorTime,children:new Date(_.timestamp).toLocaleString()})]})]})]}),e.jsx("span",{className:a.severityBadge,style:{backgroundColor:B(_.severity)},children:_.severity})]}),_.stackTrace&&e.jsxs("div",{className:a.stackTrace,children:[e.jsxs("div",{className:a.stackHeader,children:[e.jsx("h4",{children:"Stack Trace"}),e.jsxs("button",{className:a.copyButton,onClick:()=>M(_.stackTrace,"Stack Trace"),children:[e.jsx(K,{size:14}),R==="Stack Trace"?"Copied!":"Copy"]})]}),e.jsx("pre",{className:a.stackContent,children:_.stackTrace})]}),e.jsxs("div",{className:a.suggestedActions,children:[e.jsx("h4",{children:"Suggested Actions"}),e.jsx("ul",{className:a.actionsList,children:_.suggestedActions.map((r,y)=>e.jsxs("li",{className:a.actionItem,children:[e.jsx(H,{size:16,className:a.actionIcon}),r]},y))})]}),_.context&&Object.keys(_.context).length>0&&e.jsxs("div",{className:a.context,children:[e.jsx("h4",{children:"Error Context"}),e.jsx("div",{className:a.contextGrid,children:Object.entries(_.context).map(([r,y])=>e.jsxs("div",{className:a.contextItem,children:[e.jsxs("span",{className:a.contextKey,children:[r,":"]}),e.jsx("span",{className:a.contextValue,children:String(y)})]},r))})]})]}):e.jsxs("div",{className:a.noError,children:[e.jsx(H,{size:48,className:a.noErrorIcon}),e.jsx("h3",{children:"No Current Errors"}),e.jsx("p",{children:"This pipeline is currently running without any detected errors."})]}),o.length>0&&e.jsxs("div",{className:a.errorHistory,children:[e.jsx("h4",{children:"Recent Error History"}),e.jsx("div",{className:a.historyList,children:o.slice(0,5).map((r,y)=>e.jsxs("div",{className:a.historyItem,children:[e.jsx("div",{className:a.historyIcon,children:S(r.errorType)}),e.jsxs("div",{className:a.historyContent,children:[e.jsx("div",{className:a.historyMessage,children:r.errorMessage}),e.jsxs("div",{className:a.historyMeta,children:[e.jsx("span",{children:r.errorCode}),e.jsx("span",{children:new Date(r.timestamp).toLocaleString()})]})]}),e.jsx("span",{className:a.historySeverity,style:{backgroundColor:B(r.severity)},children:r.severity})]},y))})]})]}),N==="logs"&&e.jsx("div",{className:a.tabContent,children:e.jsxs("div",{className:a.logsSection,children:[e.jsx("h3",{children:"Log References"}),e.jsx("div",{className:a.logsList,children:I.map((r,y)=>e.jsxs("div",{className:a.logItem,children:[e.jsxs("div",{className:a.logHeader,children:[e.jsxs("div",{className:a.logSystem,children:[e.jsx(Y,{size:16}),r.logSystem.toUpperCase()]}),e.jsxs("button",{className:a.logButton,onClick:()=>window.open(r.logUrl,"_blank"),children:[e.jsx(U,{size:14}),"Open Logs"]})]}),e.jsxs("div",{className:a.logMeta,children:[e.jsxs("span",{children:["Correlation ID: ",r.correlationId]}),e.jsxs("span",{children:["Time Range: ",new Date(r.timeRange.start).toLocaleString()," -",new Date(r.timeRange.end).toLocaleString()]})]}),r.queryTemplate&&e.jsxs("div",{className:a.queryTemplate,children:[e.jsxs("div",{className:a.queryHeader,children:[e.jsx("span",{children:"Query Template:"}),e.jsxs("button",{className:a.copyButton,onClick:()=>M(r.queryTemplate,"Query"),children:[e.jsx(K,{size:12}),R==="Query"?"Copied!":"Copy"]})]}),e.jsx("code",{className:a.queryCode,children:r.queryTemplate})]})]},y))})]})}),N==="metrics"&&e.jsx("div",{className:a.tabContent,children:e.jsxs("div",{className:a.metricsSection,children:[e.jsx("h3",{children:"Performance Metrics History"}),e.jsxs("div",{className:a.metricsPlaceholder,children:[e.jsx(O,{size:48}),e.jsx("p",{children:"Interactive metrics charts would be displayed here"}),e.jsx("p",{children:"Showing trends for: Records/sec, Processing Time, Error Rate, Data Quality"}),T.length>0&&e.jsxs("p",{className:a.metricsInfo,children:[T.length," historical data points available"]}),f&&e.jsxs("button",{className:a.grafanaButton,onClick:()=>window.open(f,"_blank"),children:[e.jsx(U,{size:16}),"View in Grafana"]})]})]})}),N==="impact"&&e.jsx("div",{className:a.tabContent,children:w?e.jsxs("div",{className:a.impactSection,children:[e.jsxs("div",{className:a.impactOverview,children:[e.jsx("h3",{children:"Impact Analysis"}),e.jsx("div",{className:a.impactLevel,children:e.jsxs("span",{className:a.impactBadge,style:{backgroundColor:B(w.businessImpactLevel)},children:[w.businessImpactLevel.toUpperCase()," IMPACT"]})})]}),e.jsxs("div",{className:a.impactGrid,children:[e.jsxs("div",{className:a.impactCard,children:[e.jsx("h4",{children:"Affected Downstream Pipelines"}),e.jsx("div",{className:a.affectedList,children:w.affectedDownstreamPipelines.map((r,y)=>e.jsxs("div",{className:a.affectedItem,children:[e.jsx(Z,{size:14}),r]},y))})]}),e.jsxs("div",{className:a.impactCard,children:[e.jsx("h4",{children:"Affected Destinations"}),e.jsx("div",{className:a.affectedList,children:w.affectedDestinations.map((r,y)=>e.jsxs("div",{className:a.affectedItem,children:[e.jsx(Z,{size:14}),r]},y))})]}),e.jsxs("div",{className:a.impactCard,children:[e.jsx("h4",{children:"Estimated Data Loss"}),e.jsxs("div",{className:a.impactMetric,children:[w.estimatedDataLoss.toLocaleString()," records"]})]}),e.jsxs("div",{className:a.impactCard,children:[e.jsx("h4",{children:"Recovery Time Estimate"}),e.jsxs("div",{className:a.impactMetric,children:[w.recoveryTimeEstimate," minutes"]})]})]})]}):e.jsxs("div",{className:a.noImpact,children:[e.jsx(H,{size:48}),e.jsx("h3",{children:"No Current Impact"}),e.jsx("p",{children:"This pipeline failure is not currently impacting downstream systems."})]})}),N==="runbooks"&&e.jsx("div",{className:a.tabContent,children:e.jsxs("div",{className:a.runbooksSection,children:[e.jsx("h3",{children:"Resolution Runbooks"}),e.jsx("div",{className:a.runbooksList,children:b.map((r,y)=>e.jsxs("div",{className:a.runbookItem,children:[e.jsxs("div",{className:a.runbookHeader,children:[e.jsx("h4",{children:r.title}),e.jsxs("div",{className:a.runbookMeta,children:[e.jsx(Q,{size:14}),"~",r.estimatedResolutionTime," min"]})]}),e.jsx("p",{className:a.runbookDescription,children:r.description}),e.jsxs("button",{className:a.runbookButton,onClick:()=>window.open(r.url,"_blank"),children:[e.jsx(Y,{size:16}),"Open Runbook"]})]},y))}),e.jsxs("div",{className:a.oncallInfo,children:[e.jsx("h4",{children:"On-Call Team"}),e.jsxs("div",{className:a.oncallDetails,children:[e.jsx(F,{size:16}),e.jsx("span",{children:D})]})]})]})})]})]})})},Ht="_dataLineage_irt7w_2",zt="_header_irt7w_9",Et="_title_irt7w_13",Gt="_subtitle_irt7w_24",Rt="_mainContent_irt7w_31",qt="_controls_irt7w_37",Ot="_searchContainer_irt7w_49",Vt="_searchIcon_irt7w_56",Wt="_searchInput_irt7w_66",Ut="_filterSelect_irt7w_87",Ft="_clearButton_irt7w_104",Qt="_filterIndicator_irt7w_120",Xt="_clearFilterButton_irt7w_133",Kt="_contentGrid_irt7w_148",Yt="_visualizationPanel_irt7w_155",Zt="_legend_irt7w_164",Jt="_legendItem_irt7w_176",es="_legendDot_irt7w_185",ts="_source_irt7w_192",ss="_ingestion_irt7w_196",as="_transformation_irt7w_200",is="_enrichment_irt7w_204",ns="_destination_irt7w_208",rs="_lineageContainer_irt7w_212",cs="_lineageSvg_irt7w_220",os="_sectionLabel_irt7w_227",ls="_nodeGroup_irt7w_234",ds="_nodeRect_irt7w_239",ms="_selectedNode_irt7w_251",hs="_nodeText_irt7w_257",us="_nodeSubtext_irt7w_262",_s="_connectionLine_irt7w_267",xs="_flowDot_irt7w_271",fs="_tooltip_irt7w_276",ps="_sidePanel_irt7w_282",ys="_sidePanelHeader_irt7w_292",js="_sidePanelTitle_irt7w_298",gs="_statusBadge_irt7w_305",vs="_statusHealthy_irt7w_314",Ns="_statusWarning_irt7w_318",ks="_statusFailed_irt7w_322",ws="_statusProcessing_irt7w_326",Cs="_sidePanelContent_irt7w_331",Ss="_detailSection_irt7w_340",bs="_detailTitle_irt7w_346",Is="_detailDescription_irt7w_355",Ts="_metricGrid_irt7w_362",Ds="_metric_irt7w_362",Ls="_metricValue_irt7w_383",Ms="_metricLabel_irt7w_390",Bs="_connectionsList_irt7w_397",Ps="_connectionItem_irt7w_403",As="_connectionDot_irt7w_419",$s="_connectionName_irt7w_426",Hs="_connectionType_irt7w_433",zs="_activityItem_irt7w_442",Es="_activityIcon_irt7w_452",Gs="_activityText_irt7w_457",Rs="_activityTime_irt7w_463",qs="_summaryGrid_irt7w_469",Os="_summaryCard_irt7w_476",Vs="_summaryIcon_irt7w_493",Ws="_summaryContent_irt7w_504",Us="_summaryValue_irt7w_508",Fs="_summaryLabel_irt7w_516",s={dataLineage:Ht,header:zt,title:Et,subtitle:Gt,mainContent:Rt,controls:qt,searchContainer:Ot,searchIcon:Vt,searchInput:Wt,filterSelect:Ut,clearButton:Ft,filterIndicator:Qt,clearFilterButton:Xt,contentGrid:Kt,visualizationPanel:Yt,legend:Zt,legendItem:Jt,legendDot:es,source:ts,ingestion:ss,transformation:as,enrichment:is,destination:ns,lineageContainer:rs,lineageSvg:cs,sectionLabel:os,nodeGroup:ls,nodeRect:ds,selectedNode:ms,nodeText:hs,nodeSubtext:us,connectionLine:_s,flowDot:xs,tooltip:fs,sidePanel:ps,sidePanelHeader:ys,sidePanelTitle:js,statusBadge:gs,statusHealthy:vs,statusWarning:Ns,statusFailed:ks,statusProcessing:ws,sidePanelContent:Cs,detailSection:Ss,detailTitle:bs,detailDescription:Is,metricGrid:Ts,metric:Ds,metricValue:Ls,metricLabel:Ms,connectionsList:Bs,connectionItem:Ps,connectionDot:As,connectionName:$s,connectionType:Hs,activityItem:zs,activityIcon:Es,activityText:Gs,activityTime:Rs,summaryGrid:qs,summaryCard:Os,summaryIcon:Vs,summaryContent:Ws,summaryValue:Us,summaryLabel:Fs},Qs=k.memo(()=>{const[P,z]=k.useState(""),[p,_]=k.useState("all"),[o,I]=k.useState(null),[T,w]=k.useState(null),[b,D]=k.useState([]),[A,$]=k.useState(!1),E=k.useRef(null),f=t=>{let n=0;for(let c=0;c<t.length;c++){const x=t.charCodeAt(c);n=(n<<5)-n+x,n=n&n}return Math.abs(n)/2147483647},G=()=>{const t=[],n=[],c=["LinkedIn","Twitter","Office365","AzureAD","GitHub","ThreatIntel","Exchange","Teams","SharePoint","PowerBI"];return c.forEach((i,u)=>{var j;const h=f(`${i}-status`),m=["healthy","warning","failed"],d=m[Math.floor(h*m.length)],l=W.filter(V=>V.source===i),g=l.length>0?l[0]:null;t.push({id:`source-${i}`,name:i,type:"source",source:i,x:50,y:80+u*80,status:d,recordsPerSecond:Math.floor(f(`${i}-records`)*1e3)+100,avgProcessingTime:Math.floor(f(`${i}-time`)*500)+50,connections:[],description:`Data ingestion from ${i} platform`,lastUpdate:new Date(Date.now()-f(`${i}-update`)*36e5).toISOString(),dataQuality:Math.floor(f(`${i}-quality`)*20)+80,pipelineData:g,hasErrors:d==="failed"||d==="warning",errorCount:((j=g==null?void 0:g.errorHistory)==null?void 0:j.length)||(d==="failed"?3:d==="warning"?1:0)})}),[{type:"ingestion",x:350},{type:"transformation",x:650},{type:"enrichment",x:950}].forEach(({type:i,x:u})=>{const h={};W.forEach(l=>{h[l.source]||(h[l.source]=[]),h[l.source].push(l)});const m=[];c.forEach(l=>{const g=h[l]||[];if(g.length>0){const j=Math.floor(f(`${i}-${l}`)*g.length);m.push(g[j])}});const d=m.map((l,g)=>{var j;return{id:`${i}-${l.id}`,name:`${i.charAt(0).toUpperCase()+i.slice(1)} - ${l.name.split(" ").slice(0,3).join(" ")}`,type:i,source:l.source,x:u,y:80+g*80,status:l.status,recordsPerSecond:Math.floor(l.recordsProcessed/60),avgProcessingTime:l.avgProcessingTime,connections:[],description:`${i} pipeline: ${l.name}`,lastUpdate:l.lastRun.toISOString(),dataQuality:Math.floor(f(`${l.id}-quality`)*15)+85,actualPipeline:l,pipelineData:l,hasErrors:l.status==="failed"||l.status==="warning",errorCount:((j=l.errorHistory)==null?void 0:j.length)||0}});t.push(...d)}),[{name:"MSTIC Data Lake",types:["storage","archive"],priority:1},{name:"Threat Intelligence DB",types:["threat","intel"],priority:1},{name:"Security Analytics Store",types:["analytics","ml"],priority:2},{name:"Alert System",types:["realtime","alerts"],priority:1},{name:"ML Training Data",types:["ml","training"],priority:3},{name:"Compliance Archive",types:["compliance","audit"],priority:2},{name:"Real-time Dashboard",types:["realtime","dashboard"],priority:1},{name:"API Gateway",types:["api","external"],priority:2}].forEach((i,u)=>{const h=f(`${i.name}-status`),m=["healthy","warning"],d=m[Math.floor(h*m.length)];t.push({id:`dest-${i.name}`,name:i.name,type:"destination",x:1250,y:80+u*80,status:d,recordsPerSecond:Math.floor(f(`${i.name}-records`)*500)+50,avgProcessingTime:Math.floor(f(`${i.name}-time`)*100)+20,connections:[],description:`Data destination: ${i.name}`,lastUpdate:new Date(Date.now()-f(`${i.name}-update`)*18e5).toISOString(),dataQuality:Math.floor(f(`${i.name}-quality`)*10)+90,destinationTypes:i.types,priority:i.priority})}),t.forEach(i=>{if(i.type==="source")t.filter(h=>h.type==="ingestion"&&h.source===i.source).forEach(h=>{const m=`${i.id}-${h.id}`,d=f(`${m}-volume`),l=["low","medium","high"],g=l[Math.floor(d*l.length)];n.push({id:m,from:i.id,to:h.id,volume:g,health:i.status==="failed"?"error":i.status==="warning"?"warning":"healthy",animated:i.status!=="failed"}),i.connections.push(h.id),h.connections.push(i.id)});else if(i.type==="ingestion"){const u=t.find(h=>h.type==="source"&&h.source===i.source);(u==null?void 0:u.status)!=="failed"&&t.filter(m=>m.type==="transformation"&&m.source===i.source).slice(0,2).forEach(m=>{const d=`${i.id}-${m.id}`,l=f(`${d}-volume`),g=["medium","high"],j=g[Math.floor(l*g.length)];n.push({id:d,from:i.id,to:m.id,volume:j,health:i.status==="failed"?"error":i.status==="warning"?"warning":"healthy",animated:i.status!=="failed"}),i.connections.push(m.id),m.connections.push(i.id)})}else if(i.type==="transformation"){const u=t.find(m=>m.type==="ingestion"&&m.source===i.source),h=t.find(m=>m.type==="source"&&m.source===i.source);(h==null?void 0:h.status)!=="failed"&&(u==null?void 0:u.status)!=="failed"&&t.filter(d=>d.type==="enrichment"&&d.source===i.source).slice(0,2).forEach(d=>{const l=`${i.id}-${d.id}`;n.push({id:l,from:i.id,to:d.id,volume:"high",health:i.status==="failed"?"error":i.status==="warning"?"warning":"healthy",animated:i.status!=="failed"}),i.connections.push(d.id),d.connections.push(i.id)})}else if(i.type==="enrichment"){const u=t.find(d=>d.type==="source"&&d.source===i.source),h=t.find(d=>d.type==="ingestion"&&d.source===i.source),m=t.find(d=>d.type==="transformation"&&d.source===i.source);if((u==null?void 0:u.status)!=="failed"&&(h==null?void 0:h.status)!=="failed"&&(m==null?void 0:m.status)!=="failed"){const l={LinkedIn:["Threat Intelligence DB","MSTIC Data Lake","ML Training Data"],Twitter:["Real-time Dashboard","Alert System","Security Analytics Store"],Office365:["Compliance Archive","Security Analytics Store","Alert System"],AzureAD:["Security Analytics Store","Alert System","Threat Intelligence DB"],GitHub:["Threat Intelligence DB","Security Analytics Store","API Gateway"],ThreatIntel:["Alert System","Threat Intelligence DB","Real-time Dashboard"],Exchange:["Compliance Archive","Security Analytics Store","Alert System"],Teams:["Compliance Archive","Real-time Dashboard","Security Analytics Store"],SharePoint:["Compliance Archive","MSTIC Data Lake","Security Analytics Store"],PowerBI:["Real-time Dashboard","Security Analytics Store","API Gateway"]}[i.source]||["MSTIC Data Lake","Security Analytics Store","Alert System"];t.filter(j=>j.type==="destination"&&l.includes(j.name)).forEach(j=>{const V=`${i.id}-${j.id}`;n.push({id:V,from:i.id,to:j.id,volume:"high",health:i.status==="failed"?"error":i.status==="warning"?"warning":"healthy",animated:i.status!=="failed"}),i.connections.push(j.id),j.connections.push(i.id)})}}}),{nodes:t,connections:n}},{nodes:N,connections:L}=k.useMemo(()=>{const t=G(),n=t.nodes.filter(c=>c.hasErrors);return console.log("Generated nodes:",{total:t.nodes.length,withErrors:n.length,errorNodes:n.map(c=>({id:c.id,name:c.name,status:c.status,errorCount:c.errorCount}))}),t},[]),R=k.useMemo(()=>p==="all"?L:L.filter(t=>{const n=N.find(x=>x.id===t.from),c=N.find(x=>x.id===t.to);return(n==null?void 0:n.source)===p||(c==null?void 0:c.source)===p?!0:(c==null?void 0:c.type)==="destination"?L.filter(v=>{var i;return v.to===c.id&&((i=N.find(u=>u.id===v.from))==null?void 0:i.type)==="enrichment"}).some(v=>{const i=N.find(u=>u.id===v.from);return(i==null?void 0:i.source)===p}):!1}),[N,L,p]),C=N,M=R;k.useEffect(()=>{D([]),I(null)},[p]);const S=C.filter(t=>t.name.toLowerCase().includes(P.toLowerCase())||t.source&&t.source.toLowerCase().includes(P.toLowerCase())),B=t=>{const n=new Set,c=[],x=v=>{if(n.has(v))return;n.add(v),c.push(v);const i=C.find(u=>u.id===v);i&&i.connections.forEach(u=>{n.has(u)||x(u)})};x(t),D(c)},r=t=>{I(t),t.type==="source"&&t.source?(_(t.source),D([])):B(t.id)},y=t=>{console.log("Node double-clicked:",{id:t.id,name:t.name,status:t.status,hasErrors:t.hasErrors,errorCount:t.errorCount,hasPipelineData:!!t.pipelineData,pipelineDataKeys:t.pipelineData?Object.keys(t.pipelineData):[]}),(t.status==="failed"||t.status==="warning")&&t.pipelineData?(console.log("Opening error modal for node:",t.name),I(t),$(!0)):console.log("Not opening modal - conditions not met")},q=t=>{if(b.length>0&&!b.includes(t.id))return"#444";if(p!=="all"){if(t.type==="source"&&t.source===p)return"#0078d4";if(t.type==="source"&&t.source!==p)return"#333";if(t.type!=="source"&&t.type!=="destination")if(t.source===p)switch(t.type){case"ingestion":return"#52c41a";case"transformation":return"#faad14";case"enrichment":return"#8b5cf6";default:return"#888"}else return"#333";if(t.type==="destination")return M.some(c=>c.to===t.id)?"#ef4444":"#333"}switch(t.type){case"source":return"#0078d4";case"ingestion":return"#52c41a";case"transformation":return"#faad14";case"enrichment":return"#8b5cf6";case"destination":return"#ef4444";default:return"#888"}},ae=t=>{const n=b.includes(t.from)&&b.includes(t.to);return{strokeWidth:t.volume==="high"?"3":t.volume==="medium"?"2":"1",stroke:t.health==="error"?"#ef4444":t.health==="warning"?"#faad14":"#52c41a",opacity:b.length>0?n?"1":"0.2":"0.8",strokeDasharray:t.volume==="low"?"5,5":"none",markerEnd:t.health==="error"?"url(#arrowhead-error)":t.health==="warning"?"url(#arrowhead-warning)":"url(#arrowhead-healthy)"}},ie=t=>{switch(t){case"healthy":return e.jsx(H,{size:16,className:s.statusHealthy});case"warning":return e.jsx(te,{size:16,className:s.statusWarning});case"failed":return e.jsx(ee,{size:16,className:s.statusFailed});case"processing":return e.jsx(O,{size:16,className:s.statusProcessing});default:return null}},ne=[...new Set(W.map(t=>t.source))];return e.jsxs("div",{className:s.dataLineage,children:[e.jsxs("div",{className:s.header,children:[e.jsx("h1",{className:s.title,children:"Interactive Data Lineage"}),e.jsx("p",{className:s.subtitle,children:"Visualize and explore data flow through your threat intelligence pipelines"})]}),e.jsxs("div",{className:s.mainContent,children:[e.jsxs("div",{className:s.controls,children:[e.jsxs("div",{className:s.searchContainer,children:[e.jsx(ce,{className:s.searchIcon}),e.jsx("input",{type:"text",placeholder:"Search nodes and pipelines...",value:P,onChange:t=>z(t.target.value),className:s.searchInput})]}),e.jsxs("select",{value:p,onChange:t=>_(t.target.value),className:s.filterSelect,children:[e.jsx("option",{value:"all",children:"All Sources"}),ne.map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsx("button",{className:s.clearButton,onClick:()=>{I(null),D([]),_("all")},children:"Clear Selection"})]}),p!=="all"&&e.jsxs("div",{className:s.filterIndicator,children:[e.jsxs("span",{children:["Showing data flow for: ",e.jsx("strong",{children:p})]}),e.jsx("button",{className:s.clearFilterButton,onClick:()=>_("all"),title:"Show all sources",children:"×"})]}),e.jsxs("div",{className:s.contentGrid,children:[e.jsxs("div",{className:s.visualizationPanel,children:[e.jsxs("div",{className:s.legend,children:[e.jsxs("div",{className:s.legendItem,children:[e.jsx("div",{className:`${s.legendDot} ${s.source}`}),e.jsx("span",{children:"Data Sources"})]}),e.jsxs("div",{className:s.legendItem,children:[e.jsx("div",{className:`${s.legendDot} ${s.ingestion}`}),e.jsx("span",{children:"Ingestion"})]}),e.jsxs("div",{className:s.legendItem,children:[e.jsx("div",{className:`${s.legendDot} ${s.transformation}`}),e.jsx("span",{children:"Transformation"})]}),e.jsxs("div",{className:s.legendItem,children:[e.jsx("div",{className:`${s.legendDot} ${s.enrichment}`}),e.jsx("span",{children:"Enrichment"})]}),e.jsxs("div",{className:s.legendItem,children:[e.jsx("div",{className:`${s.legendDot} ${s.destination}`}),e.jsx("span",{children:"Destinations"})]})]}),e.jsx("div",{className:s.lineageContainer,children:e.jsxs("svg",{ref:E,className:s.lineageSvg,viewBox:"0 0 1600 900",preserveAspectRatio:"xMidYMid meet",children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"flowGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[e.jsx("stop",{offset:"0%",stopColor:"rgba(82, 196, 26, 0.1)"}),e.jsx("stop",{offset:"50%",stopColor:"rgba(82, 196, 26, 0.8)"}),e.jsx("stop",{offset:"100%",stopColor:"rgba(82, 196, 26, 0.1)"}),e.jsx("animateTransform",{attributeName:"gradientTransform",attributeType:"XML",type:"translate",values:"-100 0; 200 0; -100 0",dur:"3s",repeatCount:"indefinite"})]}),e.jsx("marker",{id:"arrowhead-healthy",markerWidth:"6",markerHeight:"4",refX:"5",refY:"2",orient:"auto",children:e.jsx("polygon",{points:"0 0, 6 2, 0 4",fill:"#52c41a"})}),e.jsx("marker",{id:"arrowhead-warning",markerWidth:"6",markerHeight:"4",refX:"5",refY:"2",orient:"auto",children:e.jsx("polygon",{points:"0 0, 6 2, 0 4",fill:"#faad14"})}),e.jsx("marker",{id:"arrowhead-error",markerWidth:"6",markerHeight:"4",refX:"5",refY:"2",orient:"auto",children:e.jsx("polygon",{points:"0 0, 6 2, 0 4",fill:"#ef4444"})}),e.jsxs("filter",{id:"glow",children:[e.jsx("feGaussianBlur",{stdDeviation:"3",result:"coloredBlur"}),e.jsxs("feMerge",{children:[e.jsx("feMergeNode",{in:"coloredBlur"}),e.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),e.jsx("text",{x:"120",y:"50",className:s.sectionLabel,children:"Data Sources"}),e.jsx("text",{x:"420",y:"50",className:s.sectionLabel,children:"Ingestion"}),e.jsx("text",{x:"720",y:"50",className:s.sectionLabel,children:"Transformation"}),e.jsx("text",{x:"1020",y:"50",className:s.sectionLabel,children:"Enrichment"}),e.jsx("text",{x:"1320",y:"50",className:s.sectionLabel,children:"Destinations"}),M.filter(t=>{const n=S.find(x=>x.id===t.from),c=S.find(x=>x.id===t.to);return n&&c}).map(t=>{const n=S.find(v=>v.id===t.from),c=S.find(v=>v.id===t.to),x=ae(t);return e.jsxs("g",{children:[e.jsx("line",{x1:n.x+180,y1:n.y+22,x2:c.x-20,y2:c.y+22,stroke:x.stroke,strokeWidth:x.strokeWidth,opacity:x.opacity,strokeDasharray:x.strokeDasharray,markerEnd:x.markerEnd,className:s.connectionLine}),t.animated&&e.jsx("circle",{r:"3",fill:x.stroke,className:s.flowDot,children:e.jsx("animateMotion",{dur:"3s",repeatCount:"indefinite",path:`M${n.x+180},${n.y+22} L${c.x-20},${c.y+22}`})})]},t.id)}),S.map(t=>{const n=t.type==="source"&&p!=="all"&&t.source===p;return e.jsxs("g",{className:s.nodeGroup,onClick:()=>r(t),onDoubleClick:()=>y(t),onMouseEnter:()=>w(t.id),onMouseLeave:()=>w(null),children:[e.jsx("rect",{x:t.x,y:t.y,width:"180",height:"45",fill:q(t),rx:"6",className:`${s.nodeRect} ${(o==null?void 0:o.id)===t.id?s.selectedNode:""}`,filter:(o==null?void 0:o.id)===t.id||n?"url(#glow)":"none",stroke:n?"#ffffff":"transparent",strokeWidth:n?"2":"0"}),e.jsx("text",{x:t.x+90,y:t.y+18,textAnchor:"middle",fill:"white",fontSize:"11",fontWeight:"600",className:s.nodeText,children:t.name.length>20?`${t.name.substring(0,17)}...`:t.name}),e.jsxs("text",{x:t.x+90,y:t.y+32,textAnchor:"middle",fill:"rgba(255,255,255,0.8)",fontSize:"9",className:s.nodeSubtext,children:[t.recordsPerSecond,"/s"]}),e.jsx("circle",{cx:t.x+160,cy:t.y+12,r:"5",fill:t.status==="healthy"?"#52c41a":t.status==="warning"?"#faad14":t.status==="failed"?"#ef4444":"#1890ff"}),t.hasErrors&&t.errorCount&&t.errorCount>0&&e.jsxs("g",{children:[e.jsx("circle",{cx:t.x+170,cy:t.y+35,r:"8",fill:"#ef4444",stroke:"#ffffff",strokeWidth:"1"}),e.jsx("text",{x:t.x+170,y:t.y+39,textAnchor:"middle",fill:"white",fontSize:"9",fontWeight:"700",children:t.errorCount>9?"9+":t.errorCount})]}),t.hasErrors&&e.jsx("rect",{x:t.x-2,y:t.y-2,width:"184",height:"49",fill:"none",stroke:t.status==="failed"?"#ef4444":"#faad14",strokeWidth:"2",rx:"8",className:s.errorBorder}),t.hasErrors&&T===t.id&&e.jsxs("g",{children:[e.jsx("rect",{x:t.x+20,y:t.y+55,width:"140",height:"20",fill:"rgba(0, 0, 0, 0.8)",rx:"4"}),e.jsx("text",{x:t.x+90,y:t.y+68,textAnchor:"middle",fill:"#faad14",fontSize:"10",fontWeight:"600",children:"Double-click for error details"})]})]},t.id)}),T&&S.map(t=>{if(T!==t.id)return null;const n=t.x>1e3?t.x-210:t.x+190,c=t.y-10;return e.jsxs("g",{className:s.tooltip,children:[e.jsx("rect",{x:n,y:c,width:"200",height:"60",fill:"rgba(0,0,0,0.95)",rx:"6",stroke:"#555",strokeWidth:"1"}),e.jsx("text",{x:n+10,y:c+15,fill:"white",fontSize:"11",fontWeight:"600",children:t.name}),e.jsxs("text",{x:n+10,y:c+28,fill:"#ccc",fontSize:"9",children:["Records/sec: ",t.recordsPerSecond]}),e.jsxs("text",{x:n+10,y:c+40,fill:"#ccc",fontSize:"9",children:["Avg Time: ",t.avgProcessingTime,"ms"]}),e.jsxs("text",{x:n+10,y:c+52,fill:"#ccc",fontSize:"9",children:["Quality: ",t.dataQuality,"%"]})]},`tooltip-${t.id}`)})]})})]}),o&&e.jsxs("div",{className:s.sidePanel,children:[e.jsxs("div",{className:s.sidePanelHeader,children:[e.jsx("h3",{className:s.sidePanelTitle,children:o.name}),e.jsxs("div",{className:s.statusBadge,children:[ie(o.status),e.jsx("span",{children:o.status})]})]}),e.jsxs("div",{className:s.sidePanelContent,children:[e.jsxs("div",{className:s.detailSection,children:[e.jsx("h4",{className:s.detailTitle,children:"Overview"}),e.jsx("p",{className:s.detailDescription,children:o.description}),e.jsxs("div",{className:s.metricGrid,children:[e.jsxs("div",{className:s.metric,children:[e.jsx(O,{size:16}),e.jsxs("div",{children:[e.jsxs("div",{className:s.metricValue,children:[o.recordsPerSecond,"/s"]}),e.jsx("div",{className:s.metricLabel,children:"Records per second"})]})]}),e.jsxs("div",{className:s.metric,children:[e.jsx(Q,{size:16}),e.jsxs("div",{children:[e.jsxs("div",{className:s.metricValue,children:[o.avgProcessingTime,"ms"]}),e.jsx("div",{className:s.metricLabel,children:"Avg processing time"})]})]}),e.jsxs("div",{className:s.metric,children:[e.jsx(oe,{size:16}),e.jsxs("div",{children:[e.jsxs("div",{className:s.metricValue,children:[o.dataQuality,"%"]}),e.jsx("div",{className:s.metricLabel,children:"Data quality"})]})]}),e.jsxs("div",{className:s.metric,children:[e.jsx(se,{size:16}),e.jsxs("div",{children:[e.jsx("div",{className:s.metricValue,children:o.connections.length}),e.jsx("div",{className:s.metricLabel,children:"Connections"})]})]})]})]}),e.jsxs("div",{className:s.detailSection,children:[e.jsx("h4",{className:s.detailTitle,children:"Connected Pipelines"}),e.jsx("div",{className:s.connectionsList,children:o.connections.slice(0,5).map(t=>{const n=C.find(c=>c.id===t);return n?e.jsxs("div",{className:s.connectionItem,children:[e.jsx("div",{className:s.connectionDot,style:{backgroundColor:q(n)}}),e.jsx("span",{className:s.connectionName,children:n.name}),e.jsx("span",{className:s.connectionType,children:n.type})]},t):null})})]}),e.jsxs("div",{className:s.detailSection,children:[e.jsx("h4",{className:s.detailTitle,children:"Recent Activity"}),e.jsxs("div",{className:s.activityItem,children:[e.jsx("div",{className:s.activityIcon,children:e.jsx(H,{size:14})}),e.jsxs("div",{children:[e.jsx("div",{className:s.activityText,children:"Last updated"}),e.jsx("div",{className:s.activityTime,children:new Date(o.lastUpdate).toLocaleString()})]})]})]})]})]})]})]}),e.jsxs("div",{className:s.summaryGrid,children:[e.jsxs("div",{className:s.summaryCard,children:[e.jsx("div",{className:s.summaryIcon,children:e.jsx(J,{size:24})}),e.jsxs("div",{className:s.summaryContent,children:[e.jsx("div",{className:s.summaryValue,children:C.filter(t=>t.type==="source").length}),e.jsx("div",{className:s.summaryLabel,children:"Data Sources"})]})]}),e.jsxs("div",{className:s.summaryCard,children:[e.jsx("div",{className:s.summaryIcon,children:e.jsx(le,{size:24})}),e.jsxs("div",{className:s.summaryContent,children:[e.jsx("div",{className:s.summaryValue,children:C.filter(t=>["ingestion","transformation","enrichment"].includes(t.type)).length}),e.jsx("div",{className:s.summaryLabel,children:"Processing Pipelines"})]})]}),e.jsxs("div",{className:s.summaryCard,children:[e.jsx("div",{className:s.summaryIcon,children:e.jsx(de,{size:24})}),e.jsxs("div",{className:s.summaryContent,children:[e.jsx("div",{className:s.summaryValue,children:M.length}),e.jsx("div",{className:s.summaryLabel,children:"Data Flows"})]})]}),e.jsxs("div",{className:s.summaryCard,children:[e.jsx("div",{className:s.summaryIcon,children:e.jsx(J,{size:24})}),e.jsxs("div",{className:s.summaryContent,children:[e.jsx("div",{className:s.summaryValue,children:C.filter(t=>t.type==="destination").length}),e.jsx("div",{className:s.summaryLabel,children:"Destinations"})]})]})]}),A&&o&&o.pipelineData&&e.jsx($t,{isOpen:A,onClose:()=>$(!1),pipelineName:o.pipelineData.name,currentError:o.pipelineData.currentError,errorHistory:o.pipelineData.errorHistory||[],logReferences:o.pipelineData.logReferences||[],metricsHistory:o.pipelineData.metricsHistory||[],impactAnalysis:o.pipelineData.impactAnalysis,runbooks:o.pipelineData.runbooks||[],oncallTeam:o.pipelineData.oncallTeam||"MSTIC Data Engineering",slackChannel:o.pipelineData.slackChannel,teamsChannel:o.pipelineData.teamsChannel,dashboardUrl:o.pipelineData.dashboardUrl,grafanaUrl:o.pipelineData.grafanaUrl,healthCheckUrl:o.pipelineData.healthCheckUrl})]})});Qs.displayName="DataLineage";export{Qs as default};
//# sourceMappingURL=DataLineage-DPfCkyn6.js.map
