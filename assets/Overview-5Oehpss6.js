import{g as Oe,j as e,m as Ge,a as Qe}from"./index-BVpCitbd.js";import{r as n,a as B,L as Me,C as $,X as O,Y as G,T as U,b as Q,P as We,c as Ke,d as Ae,B as He,e as Y}from"./charts-CVhI3LTv.js";import{H as Xe}from"./HowItWorksModal-DqQH_2oC.js";import{a as T,A as J}from"./azureService-DXCUUKSM.js";import{D as F,i as Ye,j as Je,P as Ze,R as qe,k as et,a as tt,b as st,T as at,A as Be,S as Ue,U as rt}from"./icons-xX1ujmH_.js";import{I as h,g as i}from"./tooltipContent-DJhswPik.js";import"./vendor-Csw2ODfV.js";import"./router-BUTKzT10.js";const Fe=()=>{const[d,m]=n.useState(!1),[u,g]=n.useState(!0),[D,j]=n.useState(null),[k,P]=n.useState(null),[w,z]=n.useState([]),[_,R]=n.useState([]),[I,M]=n.useState([]),[o,v]=n.useState([]),[b]=n.useState(()=>Oe()),f=n.useCallback(async()=>{try{const l=await T.testConnection();return m(l),l&&j(null),l}catch(l){return m(!1),j(l instanceof Error?l.message:"Connection failed"),!1}},[]),N=n.useCallback(async()=>{g(!0),j(null);try{console.log("ðŸ”„ Loading MSTIC data from Azure Data Explorer...");const[l,C,S,L,E]=await Promise.all([T.getThreatOverview(),T.getGeographicThreats(),T.getThreatCorrelations(),T.getPipelineHealth(),T.getSecurityTimeline()]);P(l),z(C),R(S),M(L),v(E),console.log("âœ… Azure data loaded successfully",{threatOverview:l,geographicThreats:C.length,threatCorrelations:S.length,pipelineHealth:L.length,securityTimeline:E.length})}catch(l){console.error("âŒ Failed to load Azure data:",l),j(l instanceof Error?l.message:"Failed to load data"),console.log("ðŸŽ­ Falling back to mock data for demo")}finally{g(!1)}},[]),A=n.useCallback(async()=>{await f(),await N()},[f,N]),W=n.useCallback(async l=>{try{return await T.executeCustomQuery(l)}catch(C){return console.error("Failed to execute custom query:",C),[]}},[]);return n.useEffect(()=>{let l=!0;return(async()=>{console.log("ðŸš€ Initializing Azure Data Explorer connection...");const S=await f();l&&(S?(console.log("âœ… Azure Data Explorer connected"),await N()):(console.log("âš ï¸ Azure Data Explorer not available - using mock data for demo"),g(!1)))})(),()=>{l=!1}},[f,N]),{isConnected:d,isLoading:u,error:D,threatOverview:k,geographicThreats:w,threatCorrelations:_,pipelineHealth:I,securityTimeline:o,mockPipelines:b,refresh:A,testConnection:f,executeCustomQuery:W}},it="_overlay_f4cdo_2",nt="_modal_f4cdo_16",ct="_header_f4cdo_39",ot="_title_f4cdo_48",lt="_icon_f4cdo_57",dt="_closeButton_f4cdo_63",mt="_content_f4cdo_84",ut="_statusSection_f4cdo_90",ht="_connectionStatus_f4cdo_94",_t="_statusDot_f4cdo_105",pt="_connected_f4cdo_113",xt="_disconnected_f4cdo_118",vt="_errorMessage_f4cdo_123",gt="_querySection_f4cdo_133",jt="_queryList_f4cdo_143",ft="_queryOption_f4cdo_149",yt="_queryLabel_f4cdo_165",bt="_queryRadio_f4cdo_173",Nt="_queryInfo_f4cdo_179",Ct="_queryName_f4cdo_185",St="_queryDescription_f4cdo_190",Tt="_copyButton_f4cdo_195",kt="_copySuccess_f4cdo_212",wt="_queryPreview_f4cdo_216",zt="_queryCode_f4cdo_226",It="_actions_f4cdo_240",Lt="_executeButton_f4cdo_244",Dt="_results_f4cdo_271",Pt="_resultCode_f4cdo_281",c={overlay:it,modal:nt,header:ct,title:ot,icon:lt,closeButton:dt,content:mt,statusSection:ut,connectionStatus:ht,statusDot:_t,connected:pt,disconnected:xt,errorMessage:vt,querySection:gt,queryList:jt,queryOption:ft,queryLabel:yt,queryRadio:bt,queryInfo:Nt,queryName:Ct,queryDescription:St,copyButton:Tt,copySuccess:kt,queryPreview:wt,queryCode:zt,actions:It,executeButton:Lt,results:Dt,resultCode:Pt},Rt=({isOpen:d,onClose:m})=>{const u=Fe(),[g,D]=n.useState("threatOverview"),[j,k]=n.useState(!1),[P,w]=n.useState(null),[z,_]=n.useState(null),R=[{key:"threatOverview",label:"Executive Threat Overview",description:"High-level security metrics for leadership"},{key:"geographicThreats",label:"Geographic Threat Analysis",description:"Threat distribution by location"},{key:"threatCorrelation",label:"Real-time Threat Correlation",description:"Live threat intelligence correlation"},{key:"pipelineHealth",label:"Pipeline Performance Metrics",description:"Data pipeline health and performance"},{key:"securityTimeline",label:"Security Incident Timeline",description:"Chronological security events"}],I=async()=>{k(!0),_(null);try{switch(await new Promise(o=>setTimeout(o,1e3)),g){case"threatOverview":_(u.threatOverview);break;case"geographicThreats":_(u.geographicThreats.slice(0,3));break;case"threatCorrelation":_(u.threatCorrelations.slice(0,5));break;case"pipelineHealth":_(u.pipelineHealth.slice(0,3));break;case"securityTimeline":_(u.securityTimeline.slice(0,5));break}}catch(o){console.error("Query execution failed:",o)}finally{k(!1)}},M=async o=>{const v=J.queries[o];try{await navigator.clipboard.writeText(v),w(o),setTimeout(()=>w(null),2e3)}catch(b){console.error("Failed to copy query:",b)}};return d?e.jsx("div",{className:c.overlay,onClick:m,children:e.jsxs("div",{className:c.modal,onClick:o=>o.stopPropagation(),children:[e.jsxs("div",{className:c.header,children:[e.jsxs("div",{className:c.title,children:[e.jsx(F,{className:c.icon}),e.jsx("span",{children:"Azure Data Explorer - Live KQL Demo"})]}),e.jsx("button",{className:c.closeButton,onClick:m,children:"Ã—"})]}),e.jsxs("div",{className:c.content,children:[e.jsxs("div",{className:c.statusSection,children:[e.jsxs("div",{className:c.connectionStatus,children:[e.jsx("div",{className:`${c.statusDot} ${u.isConnected?c.connected:c.disconnected}`}),e.jsx("span",{children:u.isConnected?`Connected to ${J.cluster}`:"Demo Mode - Azure Data Explorer unavailable"})]}),u.error&&e.jsxs("div",{className:c.errorMessage,children:["Error: ",u.error]})]}),e.jsxs("div",{className:c.querySection,children:[e.jsx("h3",{children:"Available MSTIC Queries"}),e.jsx("div",{className:c.queryList,children:R.map(o=>e.jsxs("div",{className:c.queryOption,children:[e.jsxs("label",{className:c.queryLabel,children:[e.jsx("input",{type:"radio",name:"query",value:o.key,checked:g===o.key,onChange:v=>D(v.target.value),className:c.queryRadio}),e.jsxs("div",{className:c.queryInfo,children:[e.jsx("span",{className:c.queryName,children:o.label}),e.jsx("span",{className:c.queryDescription,children:o.description})]})]}),e.jsx("button",{className:c.copyButton,onClick:()=>M(o.key),title:"Copy KQL query",children:P===o.key?e.jsx(Ye,{size:16,className:c.copySuccess}):e.jsx(Je,{size:16})})]},o.key))})]}),e.jsxs("div",{className:c.queryPreview,children:[e.jsx("h4",{children:"KQL Query:"}),e.jsx("pre",{className:c.queryCode,children:J.queries[g]})]}),e.jsx("div",{className:c.actions,children:e.jsxs("button",{className:c.executeButton,onClick:I,disabled:j||u.isLoading,children:[e.jsx(Ze,{size:16}),j?"Executing...":"Execute Query"]})}),z&&e.jsxs("div",{className:c.results,children:[e.jsx("h4",{children:"Query Results:"}),e.jsx("pre",{className:c.resultCode,children:JSON.stringify(z,null,2)})]})]})]})}):null},Mt="_overview_rvbma_1",At="_loadingContainer_rvbma_7",Ht="_loadingIcon_rvbma_16",qt="_spin_rvbma_1",Bt="_header_rvbma_27",Ut="_headerContent_rvbma_31",Ft="_titleSection_rvbma_37",Et="_title_rvbma_37",Vt="_infoButton_rvbma_51",$t="_subtitle_rvbma_71",Ot="_headerActions_rvbma_77",Gt="_howItWorksButton_rvbma_83",Qt="_refreshInfo_rvbma_109",Wt="_refreshIcon_rvbma_117",Kt="_refreshText_rvbma_122",Xt="_azureSection_rvbma_127",Yt="_azureHeader_rvbma_136",Jt="_azureTitle_rvbma_143",Zt="_azureIcon_rvbma_152",es="_azureControls_rvbma_158",ts="_azureDemoButton_rvbma_164",ss="_azureStatus_rvbma_185",as="_statusDot_rvbma_193",rs="_connected_rvbma_200",is="_disconnected_rvbma_205",ns="_azureMetrics_rvbma_210",cs="_azureMetric_rvbma_210",os="_azureMetricValue_rvbma_224",ls="_azureMetricLabel_rvbma_232",ds="_azureDemo_rvbma_164",ms="_azureGeoSection_rvbma_259",us="_geoThreatsGrid_rvbma_268",hs="_geoThreatCard_rvbma_274",_s="_geoLocation_rvbma_287",ps="_geoCountry_rvbma_291",xs="_geoCity_rvbma_298",vs="_geoMetrics_rvbma_305",gs="_geoMetric_rvbma_305",js="_geoValue_rvbma_315",fs="_geoLabel_rvbma_322",ys="_riskLevel_rvbma_331",bs="_riskBadge_rvbma_336",Ns="_low_rvbma_345",Cs="_medium_rvbma_351",Ss="_high_rvbma_357",Ts="_critical_rvbma_363",ks="_azureCorrelationSection_rvbma_370",ws="_correlationTable_rvbma_379",zs="_correlationHeader_rvbma_385",Is="_correlationRow_rvbma_399",Ls="_correlationTime_rvbma_418",Ds="_correlationUser_rvbma_423",Ps="_correlationIP_rvbma_428",Rs="_correlationThreat_rvbma_433",Ms="_correlationRisk_rvbma_438",As="_correlationPipeline_rvbma_460",Hs="_metricsHeader_rvbma_467",qs="_metricCard_rvbma_474",Bs="_metricHeader_rvbma_488",Us="_metricIcon_rvbma_494",Fs="_healthy_rvbma_501",Es="_warning_rvbma_505",Vs="_metricTitle_rvbma_509",$s="_metricValue_rvbma_515",Os="_metricSubtext_rvbma_522",Gs="_metricBreakdown_rvbma_527",Qs="_statusBadge_rvbma_534",Ws="_dashboardGrid_rvbma_544",Ks="_chartCard_rvbma_563",Xs="_chartTitle_rvbma_577",Ys="_chartSubtitle_rvbma_584",Js="_chartLegend_rvbma_592",Zs="_legendItem_rvbma_600",ea="_legendColor_rvbma_608",ta="_failingPipelinesTable_rvbma_615",sa="_tableHeader_rvbma_619",aa="_tableRow_rvbma_630",ra="_pipelineName_rvbma_643",ia="_name_rvbma_649",na="_source_rvbma_655",ca="_status_rvbma_193",oa="_failed_rvbma_679",la="_processing_rvbma_684",da="_failureRate_rvbma_689",ma="_lastRun_rvbma_695",ua="_team_rvbma_700",ha="_sla_rvbma_706",_a="_recentAlertsCard_rvbma_712",pa="_alertsList_rvbma_719",xa="_alertItem_rvbma_725",va="_alertInfo_rvbma_752",ga="_alertMessage_rvbma_758",ja="_alertTime_rvbma_763",fa="_alertSeverity_rvbma_768",ya="_securitySection_rvbma_796",ba="_sectionTitle_rvbma_805",Na="_sectionIcon_rvbma_815",Ca="_sectionSubtitle_rvbma_821",Sa="_securityGrid_rvbma_828",Ta="_securityCard_rvbma_834",ka="_chartIcon_rvbma_842",wa="_securitySummary_rvbma_849",za="_securityMetric_rvbma_859",Ia="_securityValue_rvbma_863",La="_securityLabel_rvbma_871",Da="_authPatterns_rvbma_877",Pa="_patternItem_rvbma_884",Ra="_patternValue_rvbma_892",Ma="_patternLabel_rvbma_899",Aa="_patternDesc_rvbma_905",Ha="_securityStatus_rvbma_910",qa="_statusIndicator_rvbma_918",Ba="_lastUpdate_rvbma_937",t={overview:Mt,loadingContainer:At,loadingIcon:Ht,spin:qt,header:Bt,headerContent:Ut,titleSection:Ft,title:Et,infoButton:Vt,subtitle:$t,headerActions:Ot,howItWorksButton:Gt,refreshInfo:Qt,refreshIcon:Wt,refreshText:Kt,azureSection:Xt,azureHeader:Yt,azureTitle:Jt,azureIcon:Zt,azureControls:es,azureDemoButton:ts,azureStatus:ss,statusDot:as,connected:rs,disconnected:is,azureMetrics:ns,azureMetric:cs,azureMetricValue:os,azureMetricLabel:ls,azureDemo:ds,azureGeoSection:ms,geoThreatsGrid:us,geoThreatCard:hs,geoLocation:_s,geoCountry:ps,geoCity:xs,geoMetrics:vs,geoMetric:gs,geoValue:js,geoLabel:fs,riskLevel:ys,riskBadge:bs,low:Ns,medium:Cs,high:Ss,critical:Ts,azureCorrelationSection:ks,correlationTable:ws,correlationHeader:zs,correlationRow:Is,correlationTime:Ls,correlationUser:Ds,correlationIP:Ps,correlationThreat:Rs,correlationRisk:Ms,correlationPipeline:As,metricsHeader:Hs,metricCard:qs,metricHeader:Bs,metricIcon:Us,healthy:Fs,warning:Es,metricTitle:Vs,metricValue:$s,metricSubtext:Os,metricBreakdown:Gs,statusBadge:Qs,dashboardGrid:Ws,chartCard:Ks,chartTitle:Xs,chartSubtitle:Ys,chartLegend:Js,legendItem:Zs,legendColor:ea,failingPipelinesTable:ta,tableHeader:sa,tableRow:aa,pipelineName:ra,name:ia,source:na,status:ca,failed:oa,processing:la,failureRate:da,lastRun:ma,team:ua,sla:ha,recentAlertsCard:_a,alertsList:pa,alertItem:xa,alertInfo:va,alertMessage:ga,alertTime:ja,alertSeverity:fa,securitySection:ya,sectionTitle:ba,sectionIcon:Na,sectionSubtitle:Ca,securityGrid:Sa,securityCard:Ta,chartIcon:ka,securitySummary:wa,securityMetric:za,securityValue:Ia,securityLabel:La,authPatterns:Da,patternItem:Pa,patternValue:Ra,patternLabel:Ma,patternDesc:Aa,securityStatus:Ha,statusIndicator:qa,lastUpdate:Ba},Ua=n.memo(()=>{var se,ae,re,ie,ne,ce,oe,le,de,me,ue,he,_e,pe,xe,ve,ge,je,fe,ye,be,Ne,Ce,Se,Te,ke,we,ze,Ie,Le,De,Pe,Re;const d=Fe(),[m]=n.useState(Ge),[u]=n.useState(Qe),[g,D]=n.useState(1247),[j,k]=n.useState(!0),[P,w]=n.useState(new Date),[z,_]=n.useState(!1),[R,I]=n.useState(!1),[M]=n.useState(()=>{const s=[],a=new Date;for(let r=23;r>=0;r--){const p=new Date(a.getTime()-r*60*60*1e3);s.push({time:p.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),rate:Math.floor(Math.random()*500)+800})}return s});n.useEffect(()=>{k(!1);const s=setInterval(()=>{D(a=>{const r=(Math.random()-.5)*100,p=Math.max(800,Math.min(1500,a+r));return Math.floor(p)}),w(new Date)},5e3);return()=>clearInterval(s)},[]);const o=n.useMemo(()=>({totalPipelines:m.length,healthyPipelines:m.filter(s=>s.status==="healthy").length,warningPipelines:m.filter(s=>s.status==="warning").length,failedPipelines:m.filter(s=>s.status==="failed").length,processingPipelines:m.filter(s=>s.status==="processing").length}),[m]),{totalPipelines:v,healthyPipelines:b,warningPipelines:f,failedPipelines:N,processingPipelines:A}=o,W=u.filter(s=>!s.resolved).length,l=u.filter(s=>!s.resolved&&s.severity==="critical").length,C=u.filter(s=>!s.resolved&&(s.severity==="high"||s.severity==="medium")).length,S=Math.round((b*100+f*70+A*85)/v),L=[{name:"Healthy",value:b,color:"#52c41a"},{name:"Warning",value:f,color:"#faad14"},{name:"Failed",value:N,color:"#f5222d"},{name:"Processing",value:A,color:"#1890ff"}],E=m.filter(s=>s.status==="failed"||s.status==="warning").filter(s=>s.failureRate!==void 0&&s.failureRate!==null).sort((s,a)=>(a.failureRate||0)-(s.failureRate||0)).slice(0,5),Ee=m.reduce((s,a)=>{const r=a.ownerTeam||"Unknown";return s[r]||(s[r]={total:0,healthy:0,failed:0,warning:0,processing:0,avgFailureRate:0,totalFailureRate:0}),s[r].total++,s[r][a.status]++,s[r].totalFailureRate+=a.failureRate,s},{}),K=Object.entries(Ee).map(([s,a])=>{const r=Math.round(a.healthy/a.total*100),p=Math.round(a.totalFailureRate/a.total*100)/100;return{team:s.length>15?s.substring(0,15)+"...":s,fullTeam:s,healthPercentage:r,avgFailureRate:p,total:a.total,healthy:a.healthy,failed:a.failed,warning:a.warning,processing:a.processing}}).filter(s=>s.total>=3).sort((s,a)=>a.healthPercentage-s.healthPercentage).slice(0,8),Ve=m.reduce((s,a)=>{const r=a.dataClassification||"Unknown";return s[r]||(s[r]={total:0,healthy:0,failed:0}),s[r].total++,a.status==="healthy"&&s[r].healthy++,a.status==="failed"&&s[r].failed++,s},{}),$e=Object.entries(Ve).map(([s,a])=>({name:s,total:a.total,healthy:a.healthy,failed:a.failed,healthPercentage:Math.round(a.healthy/a.total*100)})),Z=m.filter(s=>{const a=s.slaRequirement||60,r=new Date(s.lastRun);return(new Date().getTime()-r.getTime())/(1e3*60)>a&&s.status!=="processing"}),[X]=n.useState(()=>{const s=new Date,a=[];for(let r=240;r>=0;r-=10){const p=new Date(s.getTime()-r*60*1e3),y=Math.floor(Math.random()*5),x=y*3+Math.floor(Math.random()*10);a.push({time:p.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),fullTime:p,suspiciousUsers:y,totalFailedAttempts:x,threshold:3,alertedUsers:y>0?[{user:"external_user_42",attempts:5,ips:["192.168.1.100","10.0.0.50","172.16.0.200"]},{user:"temp_contractor_99",attempts:4,ips:["203.45.67.89","45.123.45.67"]},{user:"guest_account_77",attempts:3,ips:["198.51.100.14","203.0.113.45","192.0.2.100"]}].slice(0,y):[]})}return a}),H=n.useMemo(()=>{var y;const s=X.slice(-6),a=s.reduce((x,q)=>x+q.suspiciousUsers,0),r=s.reduce((x,q)=>x+q.totalFailedAttempts,0),p=s.flatMap(x=>x.alertedUsers).sort((x,q)=>q.attempts-x.attempts)[0];return{totalSuspiciousUsers:a,totalFailedAttempts:r,highestRiskUser:p,lastDetection:((y=s.find(x=>x.suspiciousUsers>0))==null?void 0:y.fullTime)||null}},[X]),[V]=n.useState(()=>({offHoursLogins:Math.floor(Math.random()*15)+5,geoAnomalies:Math.floor(Math.random()*8)+2,privilegedAccountActivity:Math.floor(Math.random()*5)+1,newDeviceLogins:Math.floor(Math.random()*25)+10})),ee=Math.round((v-Z.length)/v*100),te=s=>s>=90?"#52c41a":s>=75?"#faad14":s>=60?"#ff7a45":"#f5222d";return j?e.jsx("div",{className:t.overview,children:e.jsxs("div",{className:t.loadingContainer,children:[e.jsx(qe,{className:t.loadingIcon}),e.jsx("span",{children:"Loading dashboard..."})]})}):e.jsxs("div",{className:t.overview,children:[e.jsx("div",{className:t.header,children:e.jsxs("div",{className:t.headerContent,children:[e.jsxs("div",{className:t.titleSection,children:[e.jsxs("h1",{className:t.title,children:["Threat Intelligence Pipeline Dashboard",e.jsx("button",{className:t.infoButton,onClick:()=>_(!0),title:"How does this system work?",children:e.jsx(et,{size:18})})]}),e.jsx("p",{className:t.subtitle,children:"Real-time monitoring and analytics"})]}),e.jsx("div",{className:t.headerActions,children:e.jsxs("div",{className:t.refreshInfo,children:[e.jsx(qe,{className:t.refreshIcon}),e.jsxs("span",{className:t.refreshText,children:["Last updated: ",P.toLocaleTimeString()]})]})})]})}),e.jsxs("div",{className:t.azureSection,children:[e.jsxs("div",{className:t.azureHeader,children:[e.jsxs("div",{className:t.azureTitle,children:[e.jsx(F,{className:t.azureIcon}),e.jsx("span",{children:"Azure Data Explorer - MSTIC Threat Intelligence"})]}),e.jsxs("div",{className:t.azureControls,children:[e.jsxs("button",{className:t.azureDemoButton,onClick:()=>I(!0),title:"View live KQL queries",children:[e.jsx(F,{size:16}),"KQL Demo"]}),e.jsxs("div",{className:t.azureStatus,children:[e.jsx("div",{className:`${t.statusDot} ${d.isConnected?t.connected:t.disconnected}`}),e.jsx("span",{children:d.isConnected?"Connected":"Demo Mode"})]})]})]}),d.isConnected&&d.threatOverview&&e.jsxs("div",{className:t.azureMetrics,children:[e.jsxs("div",{className:t.azureMetric,children:[e.jsx("span",{className:t.azureMetricValue,children:d.threatOverview.TotalEvents}),e.jsx("span",{className:t.azureMetricLabel,children:"Security Events (24h)"})]}),e.jsxs("div",{className:t.azureMetric,children:[e.jsx("span",{className:t.azureMetricValue,children:d.threatOverview.HighRiskEvents}),e.jsx("span",{className:t.azureMetricLabel,children:"High-Risk Events"})]}),e.jsxs("div",{className:t.azureMetric,children:[e.jsx("span",{className:t.azureMetricValue,children:d.threatOverview.UniqueIPs}),e.jsx("span",{className:t.azureMetricLabel,children:"Unique IPs"})]}),e.jsxs("div",{className:t.azureMetric,children:[e.jsxs("span",{className:t.azureMetricValue,children:[d.threatOverview.ThreatPercentage,"%"]}),e.jsx("span",{className:t.azureMetricLabel,children:"Threat Percentage"})]})]}),!d.isConnected&&e.jsxs("div",{className:t.azureDemo,children:[e.jsx("p",{children:"Azure Data Explorer unavailable - using mock data for demonstration"}),e.jsx("p",{children:"In production: Real-time threat intelligence from SecurityEvents, ThreatIndicators, and PipelineHealth tables"})]})]}),e.jsxs("div",{className:t.metricsHeader,children:[e.jsxs("div",{className:t.metricCard,children:[e.jsxs("div",{className:t.metricHeader,children:[e.jsx(tt,{className:t.metricIcon}),e.jsxs("span",{className:t.metricTitle,children:["Total Pipelines",e.jsx(h,{content:((se=i("totalPipelines"))==null?void 0:se.content)||"Total number of threat intelligence pipelines",title:(ae=i("totalPipelines"))==null?void 0:ae.title,detailedContent:(re=i("totalPipelines"))==null?void 0:re.detailedContent,position:"top",size:"medium"})]})]}),e.jsx("div",{className:t.metricValue,children:v}),e.jsxs("div",{className:t.metricBreakdown,children:[e.jsxs("span",{className:t.statusBadge,style:{backgroundColor:"#52c41a"},children:[b," Healthy"]}),e.jsxs("span",{className:t.statusBadge,style:{backgroundColor:"#faad14"},children:[f," Warning"]}),e.jsxs("span",{className:t.statusBadge,style:{backgroundColor:"#f5222d"},children:[N," Failed"]}),e.jsxs("span",{className:t.statusBadge,style:{backgroundColor:"#1890ff"},children:[A," Processing"]})]})]}),e.jsxs("div",{className:t.metricCard,children:[e.jsxs("div",{className:t.metricHeader,children:[e.jsx(st,{className:t.metricIcon}),e.jsxs("span",{className:t.metricTitle,children:["Ingestion Rate",e.jsx(h,{content:((ie=i("ingestionRate"))==null?void 0:ie.content)||"Data ingestion rate across all pipelines",title:(ne=i("ingestionRate"))==null?void 0:ne.title,detailedContent:(ce=i("ingestionRate"))==null?void 0:ce.detailedContent,position:"top",size:"medium"})]})]}),e.jsx("div",{className:t.metricValue,children:g.toLocaleString()}),e.jsx("div",{className:t.metricSubtext,children:"files/hour"})]}),e.jsxs("div",{className:t.metricCard,children:[e.jsxs("div",{className:t.metricHeader,children:[e.jsx(at,{className:`${t.metricIcon} ${t.warning}`}),e.jsxs("span",{className:t.metricTitle,children:["Active Alerts",e.jsx(h,{content:((oe=i("activeAlerts"))==null?void 0:oe.content)||"Unresolved alerts requiring attention",title:(le=i("activeAlerts"))==null?void 0:le.title,detailedContent:(de=i("activeAlerts"))==null?void 0:de.detailedContent,position:"top",size:"medium"})]})]}),e.jsx("div",{className:t.metricValue,children:W}),e.jsxs("div",{className:t.metricSubtext,children:[l," critical, ",C," warnings"]})]}),e.jsxs("div",{className:t.metricCard,children:[e.jsxs("div",{className:t.metricHeader,children:[e.jsx(Be,{className:t.metricIcon}),e.jsxs("span",{className:t.metricTitle,children:["System Health",e.jsx(h,{content:((me=i("systemHealthScore"))==null?void 0:me.content)||"Overall system health percentage",title:(ue=i("systemHealthScore"))==null?void 0:ue.title,detailedContent:(he=i("systemHealthScore"))==null?void 0:he.detailedContent,position:"top",size:"medium"})]})]}),e.jsxs("div",{className:t.metricValue,style:{color:te(S)},children:[S,"%"]}),e.jsx("div",{className:t.metricSubtext,children:"Overall system health"})]}),e.jsxs("div",{className:t.metricCard,children:[e.jsxs("div",{className:t.metricHeader,children:[e.jsx(Be,{className:t.metricIcon}),e.jsxs("span",{className:t.metricTitle,children:["SLA Compliance",e.jsx(h,{content:((_e=i("slaCompliance"))==null?void 0:_e.content)||"Percentage meeting SLA requirements",title:(pe=i("slaCompliance"))==null?void 0:pe.title,detailedContent:(xe=i("slaCompliance"))==null?void 0:xe.detailedContent,position:"top",size:"medium"})]})]}),e.jsxs("div",{className:t.metricValue,style:{color:te(ee)},children:[ee,"%"]}),e.jsxs("div",{className:t.metricSubtext,children:[Z.length," SLA breaches",e.jsx(h,{content:((ve=i("slaBreaches"))==null?void 0:ve.content)||"Pipelines exceeding SLA requirements",title:(ge=i("slaBreaches"))==null?void 0:ge.title,detailedContent:(je=i("slaBreaches"))==null?void 0:je.detailedContent,position:"top",size:"small"})]})]})]}),d.isConnected&&d.geographicThreats.length>0&&e.jsxs("div",{className:t.azureGeoSection,children:[e.jsxs("h2",{className:t.sectionTitle,children:[e.jsx(F,{className:t.sectionIcon}),"Live Threat Intelligence - Geographic Distribution",e.jsx("span",{className:t.sectionSubtitle,children:"Real-time data from Azure Data Explorer"})]}),e.jsx("div",{className:t.geoThreatsGrid,children:d.geographicThreats.slice(0,6).map((s,a)=>{var r;return e.jsxs("div",{className:t.geoThreatCard,children:[e.jsxs("div",{className:t.geoLocation,children:[e.jsx("span",{className:t.geoCountry,children:s.Country}),s.City&&e.jsx("span",{className:t.geoCity,children:s.City})]}),e.jsxs("div",{className:t.geoMetrics,children:[e.jsxs("div",{className:t.geoMetric,children:[e.jsx("span",{className:t.geoValue,children:s.ThreatEvents}),e.jsx("span",{className:t.geoLabel,children:"Events"})]}),e.jsxs("div",{className:t.geoMetric,children:[e.jsx("span",{className:t.geoValue,children:(s.AvgRiskScore||0).toFixed(1)}),e.jsx("span",{className:t.geoLabel,children:"Risk Score"})]}),e.jsxs("div",{className:t.geoMetric,children:[e.jsx("span",{className:t.geoValue,children:s.UniqueUsers}),e.jsx("span",{className:t.geoLabel,children:"Users"})]})]}),e.jsx("div",{className:t.riskLevel,children:e.jsx("span",{className:`${t.riskBadge} ${t[((r=s.RiskLevel)==null?void 0:r.toLowerCase())||"medium"]}`,children:s.RiskLevel||"Medium"})})]},a)})})]}),e.jsxs("div",{className:t.securitySection,children:[e.jsxs("h2",{className:t.sectionTitle,children:[e.jsx(Ue,{className:t.sectionIcon}),"Security Monitoring",e.jsx("span",{className:t.sectionSubtitle,children:"Failed Login Detection & Authentication Patterns"})]}),e.jsxs("div",{className:t.securityGrid,children:[e.jsxs("div",{className:t.securityCard,children:[e.jsxs("h3",{className:t.chartTitle,children:[e.jsx(rt,{className:t.chartIcon}),"Failed Login Detection (3+ attempts, 10min window)",e.jsx(h,{content:"Monitoring for users with 3+ failed login attempts from different IP addresses within 10 minutes - classic brute force attack pattern",title:"Brute Force Detection",detailedContent:"This implements the interview scenario: detecting suspicious login patterns that could indicate credential stuffing or brute force attacks",position:"top",size:"medium"})]}),e.jsxs("div",{className:t.securitySummary,children:[e.jsxs("div",{className:t.securityMetric,children:[e.jsx("span",{className:t.securityValue,children:H.totalSuspiciousUsers}),e.jsx("span",{className:t.securityLabel,children:"Suspicious Users (Last Hour)"})]}),e.jsxs("div",{className:t.securityMetric,children:[e.jsx("span",{className:t.securityValue,children:H.totalFailedAttempts}),e.jsx("span",{className:t.securityLabel,children:"Total Failed Attempts"})]}),H.highestRiskUser&&e.jsxs("div",{className:t.securityMetric,children:[e.jsx("span",{className:t.securityValue,children:H.highestRiskUser.user}),e.jsxs("span",{className:t.securityLabel,children:["Highest Risk User (",H.highestRiskUser.attempts," attempts)"]})]})]}),e.jsx(B,{width:"100%",height:200,children:e.jsxs(Me,{data:X,children:[e.jsx($,{strokeDasharray:"3 3",stroke:"#2a2a2a"}),e.jsx(O,{dataKey:"time",stroke:"#888",fontSize:11,interval:"preserveStartEnd"}),e.jsx(G,{stroke:"#888",fontSize:11}),e.jsx(U,{contentStyle:{backgroundColor:"#1a1a1a",border:"1px solid #333",borderRadius:"4px",color:"#fff"},formatter:(s,a)=>[s,a==="suspiciousUsers"?"Suspicious Users":a==="totalFailedAttempts"?"Failed Attempts":"Threshold"]}),e.jsx(Q,{type:"monotone",dataKey:"suspiciousUsers",stroke:"#f5222d",strokeWidth:2,dot:{fill:"#f5222d",strokeWidth:2,r:3}}),e.jsx(Q,{type:"monotone",dataKey:"totalFailedAttempts",stroke:"#faad14",strokeWidth:1,strokeDasharray:"5 5",dot:!1}),e.jsx(Q,{type:"monotone",dataKey:"threshold",stroke:"#52c41a",strokeWidth:1,strokeDasharray:"2 2",dot:!1})]})})]}),e.jsxs("div",{className:t.securityCard,children:[e.jsxs("h3",{className:t.chartTitle,children:[e.jsx(Ue,{className:t.chartIcon}),"Authentication Pattern Analysis",e.jsx(h,{content:"Additional security checks for unusual authentication behaviors that could indicate compromised accounts",title:"Behavioral Analysis",detailedContent:"Monitors for off-hours logins, geographical anomalies, privileged account activity, and new device registrations",position:"top",size:"medium"})]}),e.jsxs("div",{className:t.authPatterns,children:[e.jsxs("div",{className:t.patternItem,children:[e.jsx("div",{className:t.patternValue,children:V.offHoursLogins}),e.jsx("div",{className:t.patternLabel,children:"Off-Hours Logins"}),e.jsx("div",{className:t.patternDesc,children:"2AM-6AM activity"})]}),e.jsxs("div",{className:t.patternItem,children:[e.jsx("div",{className:t.patternValue,children:V.geoAnomalies}),e.jsx("div",{className:t.patternLabel,children:"Geo Anomalies"}),e.jsx("div",{className:t.patternDesc,children:"Impossible travel"})]}),e.jsxs("div",{className:t.patternItem,children:[e.jsx("div",{className:t.patternValue,children:V.privilegedAccountActivity}),e.jsx("div",{className:t.patternLabel,children:"Privileged Alerts"}),e.jsx("div",{className:t.patternDesc,children:"Admin account flags"})]}),e.jsxs("div",{className:t.patternItem,children:[e.jsx("div",{className:t.patternValue,children:V.newDeviceLogins}),e.jsx("div",{className:t.patternLabel,children:"New Devices"}),e.jsx("div",{className:t.patternDesc,children:"Unrecognized devices"})]})]}),e.jsxs("div",{className:t.securityStatus,children:[e.jsxs("div",{className:t.statusIndicator,children:[e.jsx("div",{className:`${t.statusDot} ${t.healthy}`}),e.jsx("span",{children:"Normal patterns detected"})]}),e.jsxs("div",{className:t.lastUpdate,children:["Last updated: ",new Date().toLocaleTimeString()]})]})]})]})]}),e.jsxs("div",{className:t.dashboardGrid,children:[e.jsxs("div",{className:t.chartCard,children:[e.jsxs("h3",{className:t.chartTitle,children:["Pipeline Status Distribution",e.jsx(h,{content:((fe=i("pipelineStatusDistribution"))==null?void 0:fe.content)||"Breakdown of pipelines by operational status",title:(ye=i("pipelineStatusDistribution"))==null?void 0:ye.title,detailedContent:(be=i("pipelineStatusDistribution"))==null?void 0:be.detailedContent,position:"top",size:"medium"})]}),e.jsx(B,{width:"100%",height:300,children:e.jsxs(We,{children:[e.jsx(Ke,{data:L,cx:"50%",cy:"50%",innerRadius:80,outerRadius:120,paddingAngle:2,dataKey:"value",children:L.map((s,a)=>e.jsx(Ae,{fill:s.color},`cell-${a}`))}),e.jsx(U,{formatter:(s,a)=>[`${s} pipelines`,a],contentStyle:{backgroundColor:"#252526",border:"1px solid #333",borderRadius:"6px"}})]})}),e.jsx("div",{className:t.chartLegend,children:L.map((s,a)=>e.jsxs("div",{className:t.legendItem,children:[e.jsx("div",{className:t.legendColor,style:{backgroundColor:s.color}}),e.jsxs("span",{children:[s.name,": ",s.value]})]},a))})]}),e.jsxs("div",{className:t.chartCard,children:[e.jsxs("h3",{className:t.chartTitle,children:["Team Health Performance",e.jsx(h,{content:((Ne=i("teamHealthPerformance"))==null?void 0:Ne.content)||"Health score rankings by team",title:(Ce=i("teamHealthPerformance"))==null?void 0:Ce.title,detailedContent:(Se=i("teamHealthPerformance"))==null?void 0:Se.detailedContent,position:"top",size:"medium"}),e.jsx("span",{className:t.chartSubtitle,children:"Health Score by Team (min. 3 pipelines)"})]}),e.jsx(B,{width:"100%",height:320,children:e.jsxs(He,{data:K,layout:"horizontal",margin:{top:5,right:30,left:120,bottom:5},children:[e.jsx($,{strokeDasharray:"3 3",stroke:"#333"}),e.jsx(O,{type:"number",tick:{fill:"#ccc",fontSize:12},domain:[0,100],tickFormatter:s=>`${s}%`}),e.jsx(G,{type:"category",dataKey:"team",tick:{fill:"#ccc",fontSize:10},width:115}),e.jsx(U,{formatter:(s,a)=>a==="healthPercentage"?[`${s}%`,"Health Score"]:[s,a],labelFormatter:s=>{const a=K.find(r=>r.team===s);return a?`Team: ${a.fullTeam}`:`Team: ${s}`},contentStyle:{backgroundColor:"#252526",border:"1px solid #333",borderRadius:"6px"},content:({active:s,payload:a})=>{if(s&&a&&a[0]){const r=a[0].payload;return e.jsxs("div",{style:{backgroundColor:"#252526",border:"1px solid #333",borderRadius:"6px",padding:"8px"},children:[e.jsx("p",{style:{color:"#fff",margin:0,fontWeight:"bold"},children:r.fullTeam}),e.jsxs("p",{style:{color:"#52c41a",margin:"4px 0"},children:["Health Score: ",r.healthPercentage,"%"]}),e.jsxs("p",{style:{color:"#ccc",margin:"2px 0",fontSize:"12px"},children:["Total Pipelines: ",r.total]}),e.jsxs("p",{style:{color:"#52c41a",margin:"2px 0",fontSize:"12px"},children:["Healthy: ",r.healthy]}),e.jsxs("p",{style:{color:"#faad14",margin:"2px 0",fontSize:"12px"},children:["Warning: ",r.warning]}),e.jsxs("p",{style:{color:"#f5222d",margin:"2px 0",fontSize:"12px"},children:["Failed: ",r.failed]}),e.jsxs("p",{style:{color:"#1890ff",margin:"2px 0",fontSize:"12px"},children:["Processing: ",r.processing]})]})}return null}}),e.jsx(Y,{dataKey:"healthPercentage",radius:[0,4,4,0],children:K.map((s,a)=>e.jsx(Ae,{fill:s.healthPercentage>=90?"#52c41a":s.healthPercentage>=75?"#faad14":s.healthPercentage>=60?"#ff7a45":"#f5222d"},`cell-${a}`))})]})}),e.jsxs("div",{className:t.teamHealthLegend,children:[e.jsxs("div",{className:t.legendItem,children:[e.jsx("div",{className:t.legendColor,style:{backgroundColor:"#52c41a"}}),e.jsx("span",{children:"Excellent (90%+)"})]}),e.jsxs("div",{className:t.legendItem,children:[e.jsx("div",{className:t.legendColor,style:{backgroundColor:"#faad14"}}),e.jsx("span",{children:"Good (75-89%)"})]}),e.jsxs("div",{className:t.legendItem,children:[e.jsx("div",{className:t.legendColor,style:{backgroundColor:"#ff7a45"}}),e.jsx("span",{children:"Fair (60-74%)"})]}),e.jsxs("div",{className:t.legendItem,children:[e.jsx("div",{className:t.legendColor,style:{backgroundColor:"#f5222d"}}),e.jsx("span",{children:"Poor (<60%)"})]})]})]}),e.jsxs("div",{className:t.chartCard,children:[e.jsxs("h3",{className:t.chartTitle,children:["Data Classification Status",e.jsx(h,{content:((Te=i("dataClassificationStatus"))==null?void 0:Te.content)||"Pipeline health by data security classification",title:(ke=i("dataClassificationStatus"))==null?void 0:ke.title,detailedContent:(we=i("dataClassificationStatus"))==null?void 0:we.detailedContent,position:"top",size:"medium"})]}),e.jsx(B,{width:"100%",height:300,children:e.jsxs(He,{data:$e,children:[e.jsx($,{strokeDasharray:"3 3",stroke:"#333"}),e.jsx(O,{dataKey:"name",tick:{fill:"#ccc",fontSize:11},angle:-45,textAnchor:"end",height:80}),e.jsx(G,{tick:{fill:"#ccc"}}),e.jsx(U,{formatter:(s,a)=>a==="healthy"?[`${s} pipelines`,"Healthy"]:a==="failed"?[`${s} pipelines`,"Failed"]:[s,a],contentStyle:{backgroundColor:"#252526",border:"1px solid #333",borderRadius:"6px"}}),e.jsx(Y,{dataKey:"healthy",stackId:"a",fill:"#52c41a"}),e.jsx(Y,{dataKey:"failed",stackId:"a",fill:"#f5222d"})]})})]}),e.jsxs("div",{className:t.chartCard,children:[e.jsxs("h3",{className:t.chartTitle,children:["Ingestion Rate (Last 24 Hours)",e.jsx(h,{content:((ze=i("ingestionRateTrend"))==null?void 0:ze.content)||"Real-time data ingestion volume over 24 hours",title:(Ie=i("ingestionRateTrend"))==null?void 0:Ie.title,detailedContent:(Le=i("ingestionRateTrend"))==null?void 0:Le.detailedContent,position:"top",size:"medium"})]}),e.jsx(B,{width:"100%",height:300,children:e.jsxs(Me,{data:M,children:[e.jsx($,{strokeDasharray:"3 3",stroke:"#333"}),e.jsx(O,{dataKey:"time",tick:{fill:"#ccc",fontSize:11},interval:2}),e.jsx(G,{tick:{fill:"#ccc"},domain:["dataMin - 50","dataMax + 50"]}),e.jsx(U,{labelFormatter:s=>`Time: ${s}`,formatter:s=>[`${s} files/hour`,"Ingestion Rate"],contentStyle:{backgroundColor:"#252526",border:"1px solid #333",borderRadius:"6px"}}),e.jsx(Q,{type:"monotone",dataKey:"rate",stroke:"#1890ff",strokeWidth:2,dot:{fill:"#1890ff",strokeWidth:0,r:3},activeDot:{r:5,stroke:"#1890ff",strokeWidth:2}})]})})]}),e.jsxs("div",{className:t.chartCard,children:[e.jsxs("h3",{className:t.chartTitle,children:["Top Failing Pipelines",e.jsx(h,{content:((De=i("topFailingPipelines"))==null?void 0:De.content)||"Pipelines with highest failure rates requiring attention",title:(Pe=i("topFailingPipelines"))==null?void 0:Pe.title,detailedContent:(Re=i("topFailingPipelines"))==null?void 0:Re.detailedContent,position:"top",size:"medium"})]}),e.jsxs("div",{className:t.failingPipelinesTable,children:[e.jsxs("div",{className:t.tableHeader,children:[e.jsx("span",{children:"Pipeline"}),e.jsx("span",{children:"Team"}),e.jsx("span",{children:"Status"}),e.jsx("span",{children:"Failure Rate"}),e.jsx("span",{children:"SLA"})]}),E.map(s=>e.jsxs("div",{className:t.tableRow,children:[e.jsxs("div",{className:t.pipelineName,children:[e.jsx("span",{className:t.name,children:s.name}),e.jsx("span",{className:t.source,children:s.source})]}),e.jsx("span",{className:t.team,children:s.ownerTeam}),e.jsx("span",{className:`${t.status} ${t[s.status]}`,children:s.status}),e.jsxs("span",{className:t.failureRate,children:[(s.failureRate||0).toFixed(1),"%"]}),e.jsxs("span",{className:t.sla,children:[s.slaRequirement,"m"]})]},s.id))]})]})]}),d.isConnected&&d.threatCorrelations.length>0&&e.jsxs("div",{className:t.azureCorrelationSection,children:[e.jsxs("h2",{className:t.sectionTitle,children:[e.jsx(F,{className:t.sectionIcon}),"Real-time Threat Correlations",e.jsx("span",{className:t.sectionSubtitle,children:"Live threat intelligence from Azure Data Explorer"})]}),e.jsxs("div",{className:t.correlationTable,children:[e.jsxs("div",{className:t.correlationHeader,children:[e.jsx("span",{children:"Time"}),e.jsx("span",{children:"User"}),e.jsx("span",{children:"Source IP"}),e.jsx("span",{children:"Threat Type"}),e.jsx("span",{children:"Risk Score"}),e.jsx("span",{children:"Pipeline"})]}),d.threatCorrelations.slice(0,10).map((s,a)=>e.jsxs("div",{className:t.correlationRow,children:[e.jsx("span",{className:t.correlationTime,children:new Date(s.Timestamp).toLocaleTimeString()}),e.jsx("span",{className:t.correlationUser,children:s.UserEmail||s.UserId}),e.jsx("span",{className:t.correlationIP,children:s.SourceIP}),e.jsx("span",{className:t.correlationThreat,children:s.ThreatType}),e.jsx("span",{className:`${t.correlationRisk} ${t[(s.RiskScore||0)>80?"critical":(s.RiskScore||0)>60?"high":"medium"]}`,children:(s.RiskScore||0).toFixed(1)}),e.jsx("span",{className:t.correlationPipeline,children:s.PipelineId})]},a))]})]}),e.jsx(Xe,{isOpen:z,onClose:()=>_(!1),section:"overview"}),e.jsx(Rt,{isOpen:R,onClose:()=>I(!1)})]})});Ua.displayName="Overview";export{Ua as default};
//# sourceMappingURL=Overview-5Oehpss6.js.map
