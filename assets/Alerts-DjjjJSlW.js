import{a as X,b as Y,m as L,j as e,c as J}from"./index-BBgGgsZ5.js";import{r as c,a as Q,B as Z,c as ee,X as se,Y as te,T as ae,d as y}from"./charts-BdICjjZY.js";import{T as o,p as ie,b as re,c as $,d as ne,q as ce,h as f,r as le,s as oe,X as de,f as _e}from"./icons-C8yFdGjp.js";import"./vendor-Csw2ODfV.js";import"./router-M1Z-wYJt.js";const he="_alerts_16e9q_1",me="_header_16e9q_7",ue="_title_16e9q_11",ve="_subtitle_16e9q_18",xe="_summaryCards_16e9q_25",ye="_summaryCard_16e9q_25",je="_cardIcon_16e9q_42",pe="_critical_16e9q_51",ge="_warning_16e9q_56",Ne="_info_16e9q_61",be="_time_16e9q_66",qe="_cardContent_16e9q_71",Ce="_cardValue_16e9q_75",Se="_cardLabel_16e9q_82",fe="_chartSection_16e9q_88",we="_chartHeader_16e9q_96",Ae="_chartTitle_16e9q_103",Ie="_chartIcon_16e9q_110",Te="_chartContainer_16e9q_114",Le="_tabsContainer_16e9q_120",$e="_tabsList_16e9q_124",ke="_tabButton_16e9q_131",Me="_active_16e9q_142",He="_alertsSection_16e9q_152",Be="_alertsHeader_16e9q_159",De="_sectionTitle_16e9q_167",Re="_controls_16e9q_174",Ve="_searchContainer_16e9q_181",ze="_alertsList_16e9q_186",Fe="_alertRow_16e9q_192",Ee="_high_16e9q_208",Pe="_medium_16e9q_212",Ke="_low_16e9q_216",Ge="_alertMain_16e9q_220",Oe="_alertExpander_16e9q_229",Ue="_alertSeverity_16e9q_236",We="_alertContent_16e9q_242",Xe="_alertMessage_16e9q_246",Ye="_alertMeta_16e9q_252",Je="_pipeline_16e9q_261",Qe="_acknowledged_16e9q_266",Ze="_alertActions_16e9q_273",es="_actionBtn_16e9q_278",ss="_acknowledge_16e9q_266",ts="_resolve_16e9q_303",as="_dismiss_16e9q_312",is="_alertDetails_16e9q_321",rs="_detailsContent_16e9q_327",ns="_detailsSection_16e9q_333",cs="_actionsList_16e9q_349",ls="_tabContainer_16e9q_361",os="_tabs_16e9q_120",ds="_tab_16e9q_120",_s="_activeTab_16e9q_390",hs="_tabContent_16e9q_396",ms="_table_16e9q_401",us="_tableHeader_16e9q_409",vs="_tableHeaderRow_16e9q_414",xs="_tableHeaderCell_16e9q_422",ys="_sortIcon_16e9q_437",js="_sorted_16e9q_443",ps="_tableBody_16e9q_448",gs="_tableRow_16e9q_453",Ns="_tableCell_16e9q_480",bs="_expandIcon_16e9q_488",qs="_expanded_16e9q_495",Cs="_severityBadge_16e9q_499",Ss="_severityIcon_16e9q_524",fs="_detailsMain_16e9q_544",ws="_detailsLabel_16e9q_556",As="_detailsValue_16e9q_564",Is="_detailsActions_16e9q_569",Ts="_actionButtons_16e9q_576",Ls="_actionButton_16e9q_576",$s="_investigate_16e9q_612",ks="_rulesSection_16e9q_646",Ms="_rulesHeader_16e9q_653",Hs="_sectionSubtitle_16e9q_657",Bs="_rulesList_16e9q_663",Ds="_ruleCard_16e9q_669",Rs="_disabled_16e9q_681",Vs="_ruleHeader_16e9q_685",zs="_ruleInfo_16e9q_693",Fs="_ruleName_16e9q_697",Es="_ruleDescription_16e9q_704",Ps="_ruleToggle_16e9q_710",Ks="_slider_16e9q_727",Gs="_ruleDetails_16e9q_759",Os="_ruleMetric_16e9q_767",Us="_ruleCondition_16e9q_768",Ws="_ruleSeverity_16e9q_769",Xs="_metricLabel_16e9q_775",Ys="_conditionLabel_16e9q_776",Js="_severityLabel_16e9q_777",Qs="_metricValue_16e9q_785",Zs="_conditionValue_16e9q_786",et="_historySection_16e9q_823",st="_historyHeader_16e9q_830",tt="_historyList_16e9q_838",at="_historyItem_16e9q_844",it="_historySeverity_16e9q_871",rt="_historyContent_16e9q_877",nt="_historyMessage_16e9q_881",ct="_historyMeta_16e9q_887",lt="_resolution_16e9q_896",ot="_historyStatus_16e9q_900",dt="_resolvedIcon_16e9q_908",_t="_historyFilters_16e9q_913",ht="_searchIcon_16e9q_927",mt="_searchInput_16e9q_937",ut="_filterSelect_16e9q_956",vt="_historyStats_16e9q_971",xt="_historyStat_16e9q_900",yt="_historyStatValue_16e9q_986",jt="_historyStatLabel_16e9q_993",pt="_emptyState_16e9q_999",gt="_emptyIcon_16e9q_1007",Nt="_emptyTitle_16e9q_1012",bt="_emptySubtitle_16e9q_1019",qt="_rulesGrid_16e9q_1062",s={alerts:he,header:me,title:ue,subtitle:ve,summaryCards:xe,summaryCard:ye,cardIcon:je,critical:pe,warning:ge,info:Ne,time:be,cardContent:qe,cardValue:Ce,cardLabel:Se,chartSection:fe,chartHeader:we,chartTitle:Ae,chartIcon:Ie,chartContainer:Te,tabsContainer:Le,tabsList:$e,tabButton:ke,active:Me,alertsSection:He,alertsHeader:Be,sectionTitle:De,controls:Re,searchContainer:Ve,alertsList:ze,alertRow:Fe,high:Ee,medium:Pe,low:Ke,alertMain:Ge,alertExpander:Oe,alertSeverity:Ue,alertContent:We,alertMessage:Xe,alertMeta:Ye,pipeline:Je,acknowledged:Qe,alertActions:Ze,actionBtn:es,acknowledge:ss,resolve:ts,dismiss:as,alertDetails:is,detailsContent:rs,detailsSection:ns,actionsList:cs,tabContainer:ls,tabs:os,tab:ds,activeTab:_s,tabContent:hs,table:ms,tableHeader:us,tableHeaderRow:vs,tableHeaderCell:xs,sortIcon:ys,sorted:js,tableBody:ps,tableRow:gs,tableCell:Ns,expandIcon:bs,expanded:qs,severityBadge:Cs,severityIcon:Ss,detailsMain:fs,detailsLabel:ws,detailsValue:As,detailsActions:Is,actionButtons:Ts,actionButton:Ls,investigate:$s,rulesSection:ks,rulesHeader:Ms,sectionSubtitle:Hs,rulesList:Bs,ruleCard:Ds,disabled:Rs,ruleHeader:Vs,ruleInfo:zs,ruleName:Fs,ruleDescription:Es,ruleToggle:Ps,switch:"_switch_16e9q_714",slider:Ks,ruleDetails:Gs,ruleMetric:Os,ruleCondition:Us,ruleSeverity:Ws,metricLabel:Xs,conditionLabel:Ys,severityLabel:Js,metricValue:Qs,conditionValue:Zs,historySection:et,historyHeader:st,historyList:tt,historyItem:at,historySeverity:it,historyContent:rt,historyMessage:nt,historyMeta:ct,resolution:lt,historyStatus:ot,resolvedIcon:dt,historyFilters:_t,searchIcon:ht,searchInput:mt,filterSelect:ut,historyStats:vt,historyStat:xt,historyStatValue:yt,historyStatLabel:jt,emptyState:pt,emptyIcon:gt,emptyTitle:Nt,emptySubtitle:bt,rulesGrid:qt},Ct=c.memo(()=>{const[h,k]=c.useState(X),[w,M]=c.useState(Y),[d,A]=c.useState(""),[m,H]=c.useState("all"),[j,B]=c.useState("timestamp"),[p,D]=c.useState("desc"),[v,R]=c.useState(null),[_,g]=c.useState("active"),x=c.useMemo(()=>h.filter(t=>{const a=L.find(n=>n.id===t.pipelineId),i=t.message.toLowerCase().includes(d.toLowerCase())||(a==null?void 0:a.name.toLowerCase().includes(d.toLowerCase())),r=m==="all"||t.severity===m;return i&&r}).sort((t,a)=>{let i,r;switch(j){case"timestamp":i=t.timestamp.getTime(),r=a.timestamp.getTime();break;case"severity":const n={low:1,medium:2,high:3,critical:4};i=n[t.severity],r=n[a.severity];break;case"duration":const l=new Date;i=l.getTime()-t.timestamp.getTime(),r=l.getTime()-a.timestamp.getTime();break;default:return 0}return p==="asc"?i<r?-1:i>r?1:0:i>r?-1:i<r?1:0}),[h,d,m,j,p]),u=h.filter(t=>!t.resolved),V=u.filter(t=>t.severity==="critical"),z=u.filter(t=>t.severity==="high"),F=u.filter(t=>t.severity==="medium"||t.severity==="low"),N=h.filter(t=>t.resolved&&t.resolvedAt),E=N.length>0?N.reduce((t,a)=>a.resolvedAt?t+(a.resolvedAt.getTime()-a.timestamp.getTime()):t,0)/N.length/(1e3*60*60):0,I=t=>{switch(t){case"critical":return e.jsx(o,{className:`${s.severityIcon} ${s.critical}`});case"high":return e.jsx(o,{className:`${s.severityIcon} ${s.high}`});case"medium":return e.jsx(o,{className:`${s.severityIcon} ${s.medium}`});case"low":return e.jsx(o,{className:`${s.severityIcon} ${s.low}`});default:return e.jsx(o,{className:s.severityIcon})}},b=t=>{const a=new Date,i=t.timestamp,n=(t.resolved&&t.resolvedAt?t.resolvedAt:a).getTime()-i.getTime(),l=Math.floor(n/(1e3*60*60)),T=Math.floor(n%(1e3*60*60)/(1e3*60));return l>0?`${l}h ${T}m`:`${T}m`},q=t=>{const i=new Date().getTime()-t.getTime(),r=Math.floor(i/(1e3*60)),n=Math.floor(r/60),l=Math.floor(n/24);return l>0?`${l} day${l>1?"s":""} ago`:n>0?`${n} hour${n>1?"s":""} ago`:r>0?`${r} minute${r>1?"s":""} ago`:"Just now"},C=t=>{const a=L.find(i=>i.id===t);return(a==null?void 0:a.name)||"Unknown Pipeline"},S=(t,a)=>{k(i=>i.map(r=>{if(r.id===t)switch(a){case"acknowledge":return{...r,acknowledgedBy:"current-user@microsoft.com"};case"resolve":return{...r,resolved:!0,resolvedAt:new Date,acknowledgedBy:"current-user@microsoft.com"};case"dismiss":return{...r,resolved:!0,resolvedAt:new Date};default:return r}return r}))},P=t=>{M(a=>a.map(i=>i.id===t?{...i,enabled:!i.enabled}:i))},K=()=>e.jsxs("div",{className:s.summaryCards,children:[e.jsxs("div",{className:s.summaryCard,children:[e.jsx("div",{className:`${s.cardIcon} ${s.critical}`,children:e.jsx(o,{size:24})}),e.jsxs("div",{className:s.cardContent,children:[e.jsx("div",{className:s.cardValue,children:V.length}),e.jsx("div",{className:s.cardLabel,children:"Critical Alerts"})]})]}),e.jsxs("div",{className:s.summaryCard,children:[e.jsx("div",{className:`${s.cardIcon} ${s.warning}`,children:e.jsx(o,{size:24})}),e.jsxs("div",{className:s.cardContent,children:[e.jsx("div",{className:s.cardValue,children:z.length}),e.jsx("div",{className:s.cardLabel,children:"Warning Alerts"})]})]}),e.jsxs("div",{className:s.summaryCard,children:[e.jsx("div",{className:`${s.cardIcon} ${s.info}`,children:e.jsx(o,{size:24})}),e.jsxs("div",{className:s.cardContent,children:[e.jsx("div",{className:s.cardValue,children:F.length}),e.jsx("div",{className:s.cardLabel,children:"Info Alerts"})]})]}),e.jsxs("div",{className:s.summaryCard,children:[e.jsx("div",{className:`${s.cardIcon} ${s.time}`,children:e.jsx(ie,{size:24})}),e.jsxs("div",{className:s.cardContent,children:[e.jsxs("div",{className:s.cardValue,children:[E.toFixed(1),"h"]}),e.jsx("div",{className:s.cardLabel,children:"Mean Time to Resolution"})]})]})]}),G=()=>e.jsxs("div",{className:s.chartSection,children:[e.jsxs("div",{className:s.chartHeader,children:[e.jsx("h3",{className:s.chartTitle,children:"Alert Trends (Last 7 Days)"}),e.jsx(re,{className:s.chartIcon})]}),e.jsx("div",{className:s.chartContainer,children:e.jsx(Q,{width:"100%",height:300,children:e.jsxs(Z,{data:J,children:[e.jsx(ee,{strokeDasharray:"3 3",stroke:"var(--border-light)"}),e.jsx(se,{dataKey:"date",stroke:"var(--text-secondary)",fontSize:12}),e.jsx(te,{stroke:"var(--text-secondary)",fontSize:12}),e.jsx(ae,{contentStyle:{backgroundColor:"var(--bg-secondary)",border:"1px solid var(--border-light)",borderRadius:"8px",color:"var(--text-primary)"}}),e.jsx(y,{dataKey:"critical",fill:"#dc3545",name:"Critical"}),e.jsx(y,{dataKey:"high",fill:"#fd7e14",name:"High"}),e.jsx(y,{dataKey:"medium",fill:"#ffc107",name:"Medium"}),e.jsx(y,{dataKey:"low",fill:"#28a745",name:"Low"})]})})})]}),O=()=>e.jsxs("div",{className:s.alertsSection,children:[e.jsxs("div",{className:s.alertsHeader,children:[e.jsxs("h3",{className:s.sectionTitle,children:["Active Alerts (",u.length,")"]}),e.jsxs("div",{className:s.controls,children:[e.jsxs("div",{className:s.searchContainer,children:[e.jsx($,{size:16,className:s.searchIcon}),e.jsx("input",{type:"text",placeholder:"Search alerts...",value:d,onChange:t=>A(t.target.value),className:s.searchInput})]}),e.jsxs("select",{value:m,onChange:t=>H(t.target.value),className:s.filterSelect,children:[e.jsx("option",{value:"all",children:"All Severities"}),e.jsx("option",{value:"critical",children:"Critical"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"low",children:"Low"})]}),e.jsxs("select",{value:`${j}-${p}`,onChange:t=>{const[a,i]=t.target.value.split("-");B(a),D(i)},className:s.filterSelect,children:[e.jsx("option",{value:"timestamp-desc",children:"Newest First"}),e.jsx("option",{value:"timestamp-asc",children:"Oldest First"}),e.jsx("option",{value:"severity-desc",children:"Severity (High to Low)"}),e.jsx("option",{value:"severity-asc",children:"Severity (Low to High)"}),e.jsx("option",{value:"duration-desc",children:"Duration (Longest First)"}),e.jsx("option",{value:"duration-asc",children:"Duration (Shortest First)"})]})]})]}),e.jsx("div",{className:s.alertsList,children:x.filter(t=>!t.resolved).map(t=>e.jsxs("div",{className:`${s.alertRow} ${s[t.severity]} ${v===t.id?s.expanded:""}`,children:[e.jsxs("div",{className:s.alertMain,onClick:()=>R(v===t.id?null:t.id),children:[e.jsx("div",{className:s.alertExpander,children:v===t.id?e.jsx(ne,{size:16}):e.jsx(ce,{size:16})}),e.jsx("div",{className:s.alertSeverity,children:I(t.severity)}),e.jsxs("div",{className:s.alertContent,children:[e.jsx("div",{className:s.alertMessage,children:t.message}),e.jsxs("div",{className:s.alertMeta,children:[e.jsx("span",{className:s.pipeline,children:C(t.pipelineId)}),e.jsx("span",{className:s.timestamp,children:q(t.timestamp)}),e.jsxs("span",{className:s.duration,children:["Duration: ",b(t)]}),t.acknowledgedBy&&e.jsxs("span",{className:s.acknowledged,children:[e.jsx(f,{size:14})," Acknowledged"]})]})]}),e.jsxs("div",{className:s.alertActions,children:[!t.acknowledgedBy&&e.jsx("button",{onClick:a=>{a.stopPropagation(),S(t.id,"acknowledge")},className:`${s.actionBtn} ${s.acknowledge}`,title:"Acknowledge",children:e.jsx(le,{size:16})}),e.jsx("button",{onClick:a=>{a.stopPropagation(),S(t.id,"resolve")},className:`${s.actionBtn} ${s.resolve}`,title:"Resolve",children:e.jsx(oe,{size:16})}),e.jsx("button",{onClick:a=>{a.stopPropagation(),S(t.id,"dismiss")},className:`${s.actionBtn} ${s.dismiss}`,title:"Dismiss",children:e.jsx(de,{size:16})})]})]}),v===t.id&&e.jsx("div",{className:s.alertDetails,children:e.jsxs("div",{className:s.detailsContent,children:[e.jsxs("div",{className:s.detailsSection,children:[e.jsx("h4",{children:"Alert Details"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Description:"})," ",t.description]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Pipeline:"})," ",C(t.pipelineId)]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Triggered:"})," ",t.timestamp.toLocaleString()]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Duration:"})," ",b(t)]}),t.acknowledgedBy&&e.jsxs("p",{children:[e.jsx("strong",{children:"Acknowledged by:"})," ",t.acknowledgedBy]})]}),t.actions&&t.actions.length>0&&e.jsxs("div",{className:s.detailsSection,children:[e.jsx("h4",{children:"Recommended Actions"}),e.jsx("ul",{className:s.actionsList,children:t.actions.map((a,i)=>e.jsx("li",{children:a},i))})]})]})})]},t.id))}),x.filter(t=>!t.resolved).length===0&&e.jsxs("div",{className:s.emptyState,children:[e.jsx(f,{size:48,className:s.emptyIcon}),e.jsx("h3",{className:s.emptyTitle,children:"No active alerts"}),e.jsx("p",{className:s.emptySubtitle,children:d||m!=="all"?"No alerts match your current filters.":"All systems are running smoothly."})]})]}),U=()=>e.jsxs("div",{className:s.rulesSection,children:[e.jsxs("div",{className:s.rulesHeader,children:[e.jsx("h3",{className:s.sectionTitle,children:"Alert Rules"}),e.jsx("p",{className:s.sectionSubtitle,children:"Configure threshold-based alert rules for your pipelines"})]}),e.jsx("div",{className:s.rulesList,children:w.map(t=>e.jsxs("div",{className:`${s.ruleCard} ${t.enabled?"":s.disabled}`,children:[e.jsxs("div",{className:s.ruleHeader,children:[e.jsxs("div",{className:s.ruleInfo,children:[e.jsx("h4",{className:s.ruleName,children:t.name}),e.jsx("p",{className:s.ruleDescription,children:t.description})]}),e.jsx("div",{className:s.ruleToggle,children:e.jsxs("label",{className:s.switch,children:[e.jsx("input",{type:"checkbox",checked:t.enabled,onChange:()=>P(t.id)}),e.jsx("span",{className:s.slider})]})})]}),e.jsxs("div",{className:s.ruleDetails,children:[e.jsxs("div",{className:s.ruleMetric,children:[e.jsx("span",{className:s.metricLabel,children:"Type:"}),e.jsx("span",{className:s.metricValue,children:t.type})]}),e.jsxs("div",{className:s.ruleCondition,children:[e.jsx("span",{className:s.conditionLabel,children:"Threshold:"}),e.jsxs("span",{className:s.conditionValue,children:[t.threshold?`${t.threshold}`:"N/A",t.timeWindow?` (${t.timeWindow}min window)`:""]})]}),e.jsxs("div",{className:s.ruleSeverity,children:[e.jsx("span",{className:s.severityLabel,children:"Severity:"}),e.jsx("span",{className:`${s.severityBadge} ${s[t.severity]}`,children:t.severity.charAt(0).toUpperCase()+t.severity.slice(1)})]})]})]},t.id))})]}),W=()=>e.jsxs("div",{className:s.historySection,children:[e.jsxs("div",{className:s.historyHeader,children:[e.jsx("h3",{className:s.sectionTitle,children:"Alert History"}),e.jsxs("div",{className:s.searchBox,children:[e.jsx($,{size:16,className:s.searchIcon}),e.jsx("input",{type:"text",placeholder:"Search resolved alerts...",value:d,onChange:t=>A(t.target.value),className:s.searchInput})]})]}),e.jsx("div",{className:s.historyList,children:x.filter(t=>t.resolved).map(t=>e.jsxs("div",{className:`${s.historyItem} ${s[t.severity]}`,children:[e.jsx("div",{className:s.historySeverity,children:I(t.severity)}),e.jsxs("div",{className:s.historyContent,children:[e.jsx("div",{className:s.historyMessage,children:t.message}),e.jsxs("div",{className:s.historyMeta,children:[e.jsx("span",{className:s.pipeline,children:C(t.pipelineId)}),e.jsxs("span",{className:s.timestamp,children:["Triggered: ",q(t.timestamp)]}),t.resolvedAt&&e.jsxs("span",{className:s.resolution,children:["Resolved: ",q(t.resolvedAt)]}),e.jsxs("span",{children:["Resolution Time: ",b(t)]})]})]}),e.jsxs("div",{className:s.historyStatus,children:[e.jsx(f,{size:16,className:s.resolvedIcon}),e.jsx("span",{children:"Resolved"})]})]},t.id))}),x.filter(t=>t.resolved).length===0&&e.jsxs("div",{className:s.emptyState,children:[e.jsx(_e,{size:48,className:s.emptyIcon}),e.jsx("h3",{className:s.emptyTitle,children:"No resolved alerts found"}),e.jsx("p",{className:s.emptySubtitle,children:"Resolved alerts will appear here for historical reference."})]})]});return e.jsxs("div",{className:s.alerts,children:[e.jsxs("div",{className:s.header,children:[e.jsx("h1",{className:s.title,children:"Alert Management"}),e.jsx("p",{className:s.subtitle,children:"Monitor and manage security alerts from your threat intelligence pipelines"})]}),K(),G(),e.jsxs("div",{className:s.tabContainer,children:[e.jsxs("div",{className:s.tabs,children:[e.jsxs("button",{className:`${s.tab} ${_==="active"?s.activeTab:""}`,onClick:()=>g("active"),children:["Active Alerts (",u.length,")"]}),e.jsxs("button",{className:`${s.tab} ${_==="rules"?s.activeTab:""}`,onClick:()=>g("rules"),children:["Alert Rules (",w.filter(t=>t.enabled).length," enabled)"]}),e.jsxs("button",{className:`${s.tab} ${_==="history"?s.activeTab:""}`,onClick:()=>g("history"),children:["History (",h.filter(t=>t.resolved).length," resolved)"]})]}),e.jsxs("div",{className:s.tabContent,children:[_==="active"&&O(),_==="rules"&&U(),_==="history"&&W()]})]})]})});Ct.displayName="Alerts";export{Ct as default};
//# sourceMappingURL=Alerts-DjjjJSlW.js.map
